(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50f6915e"],{2684:function(e,t,a){"use strict";var r=a("6a5e"),s=a.n(r);s.a},"332b":function(e,t,a){"use strict";var r=a("8320"),s=a.n(r);s.a},3436:function(e,t,a){"use strict";var r=a("c9a5"),s=a.n(r);s.a},3595:function(e,t,a){},"3d70":function(e,t,a){},4280:function(e,t,a){"use strict";var r=a("9b73"),s=a.n(r);s.a},4361:function(e,t,a){"use strict";a.d(t,"c",function(){return s}),a.d(t,"h",function(){return o}),a.d(t,"e",function(){return n}),a.d(t,"g",function(){return i}),a.d(t,"f",function(){return l}),a.d(t,"a",function(){return d}),a.d(t,"d",function(){return c}),a.d(t,"b",function(){return u}),a.d(t,"i",function(){return h});var r=a("6b6c"),s=function(e){return r["a"].request({url:"/smartLock/getApplyPasswd.action",method:"get",params:e})},o=function(e){return r["a"].request({url:"/smartLock/save.action",method:"post",data:e})},n=function(e){return r["a"].request({url:"/smartLock/getOrderPswLockList.action",method:"post",data:e})},i=function(e){return r["a"].request({url:"/smartLock/resetOrderPassword.action",method:"post",data:e})},l=function(e){return r["a"].request({url:"/smartLock/getWorkPassword.action",method:"get",params:e})},d=function(e){return r["a"].request({url:"/smartLock/applyWorkPassword.action",method:"post",data:e})},c=function(e){return r["a"].request({url:"/smartLock/getPowerInfo.action",method:"get",params:e})},u=function(e){return r["a"].request({url:"/smartLock/checkDoorPwd.action",method:"get",params:{orderBid:e}})},h=function(e){return r["a"].request({url:"/smartLock/sendDoorPwd.action",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{orderBid:e}})}},"6a5e":function(e,t,a){},"73bf":function(e,t,a){"use strict";var r=a("3595"),s=a.n(r);s.a},"798d":function(e,t,a){},"7f54":function(e,t,a){"use strict";var r=a("ea1e"),s=a.n(r);s.a},8320:function(e,t,a){},"93bd":function(e,t,a){"use strict";var r=a("b143"),s=a.n(r);s.a},"955e":function(e,t,a){},"9b73":function(e,t,a){},a219:function(e,t,a){"use strict";var r=a("798d"),s=a.n(r);s.a},b143:function(e,t,a){},b167:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"con"},[e.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):e._e(),Object.keys(e.orderInfo).length?a("div",{staticClass:"subscript",style:{backgroundColor:e.orderStatusBC}},[e._v("\n    "+e._s(e._f("orderStatusFilter")(e.orderInfo.orderStatus))+"\n  ")]):e._e(),Object.keys(e.orderInfo).length?a("Row",[a("Col",{attrs:{span:12}},[a("strong",{staticClass:"order order-number"},[e._v("订单号："+e._s(e.orderNumber))]),a("strong",{staticClass:"order order-price"},[e._v("¥ "+e._s(e.orderInfo.amountNoCoupon))])]),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("ButtonGroup",[a("Button",{attrs:{type:"primary",icon:"ios-time-outline",ghost:""},on:{click:function(t){e.logVisible=!0}}},[e._v("订单日志")]),a("Button",{attrs:{type:"primary",icon:"ios-card",ghost:""},on:{click:function(t){e.paymentVisible=!0}}},[e._v("支付明细")]),a("Button",{attrs:{type:"primary",icon:"ios-print-outline",ghost:""},on:{click:e.printRegistrationForm}},[e._v("打印")]),a("Button",{attrs:{type:"primary",icon:"ios-mail-outline",ghost:""},on:{click:function(t){e.mailVisible=!0}}},[e._v("发送邮件")])],1)],1)],1):e._e(),Object.keys(e.orderInfo).length?a("base-info-card",{staticClass:"card-cls",attrs:{order:e.orderInfo,coupon:e.ticketInfo,channel:e.firstChannel},on:{updatePhone:e.updatePhone,updateMail:e.updateMail,refresh:e.getOrderDetail}}):e._e(),a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:18}},[Object.keys(e.orderInfo).length?a("stay-person-card",{staticClass:"card-cls",attrs:{"stay-list":e.orderInfo.stayPersonDtoList,"guest-type":e.guestType,"order-bid":e.orderInfo.orderBid,"order-status":e.orderInfo.orderStatus},on:{save:e.saveStayPerson}}):e._e()],1),a("Col",{attrs:{span:6}},[Object.keys(e.orderInfo).length?a("order-remark-card",{ref:"remarkRef",staticClass:"card-cls",attrs:{remarks:e.recordList},on:{save:e.saveOrderRemark}}):e._e()],1)],1),Object.keys(e.orderInfo).length&&5!==e.orderInfo.orderStatus&&7!==e.orderInfo.orderStatus?a("order-action-card",{staticClass:"card-cls",staticStyle:{"margin-bottom":"20px"},attrs:{order:e.orderInfo,"has-check-in":e.hasCheckInStayPerson,"lock-pwd-list":e.lockPwdList,"lock-pwd-have1":e.lockPwdHave1,"lock-pwd-have2":e.lockPwdHave2},on:{refresh:e.getOrderDetail}}):e._e(),a("Modal",{attrs:{title:"订单日志",width:"800","footer-hide":""},model:{value:e.logVisible,callback:function(t){e.logVisible=t},expression:"logVisible"}},[a("div",{style:{paddingLeft:"20px"}},[e.logVisible?a("order-log",{attrs:{"order-bid":e.orderInfo.orderBid}}):e._e()],1)]),a("Modal",{attrs:{title:"支付明细",width:"60","footer-hide":""},model:{value:e.paymentVisible,callback:function(t){e.paymentVisible=t},expression:"paymentVisible"}},[a("div",{style:{paddingLeft:"20px"}},[e.paymentVisible?a("payment-detail",{attrs:{"order-bid":e.orderInfo.orderBid}}):e._e()],1)]),a("Modal",{attrs:{loading:e.phoneLoading,title:"修改预定手机号",width:"500"},on:{"on-ok":e.validPhone},model:{value:e.phoneVisible,callback:function(t){e.phoneVisible=t},expression:"phoneVisible"}},[a("Form",{ref:"cusPhoneForm",attrs:{model:e.phoneDto,"label-width":100}},[a("FormItem",{attrs:{label:"预定手机号",prop:"phone",rules:[{required:!0,message:"请输入预定手机号",trigger:"blur"},{pattern:/^1\d{10}$/,message:"手机号格式有误",trigger:"blur"}]}},[a("Input",{attrs:{placeholder:"",clearable:""},model:{value:e.phoneDto.phone,callback:function(t){e.$set(e.phoneDto,"phone","string"===typeof t?t.trim():t)},expression:"phoneDto.phone"}})],1)],1)],1),a("Modal",{attrs:{loading:e.phoneLoading,title:"发送邮件",width:"500"},on:{"on-ok":e.validMail},model:{value:e.mailVisible,callback:function(t){e.mailVisible=t},expression:"mailVisible"}},[a("Form",{ref:"mailForm",attrs:{model:e.mailDto,"label-width":50}},[a("FormItem",{attrs:{label:"邮箱",prop:"email",rules:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,message:"邮箱格式有误",trigger:"blur"}]}},[a("Input",{attrs:{placeholder:"请输入邮箱",maxlength:200,clearable:""},model:{value:e.mailDto.email,callback:function(t){e.$set(e.mailDto,"email","string"===typeof t?t.trim():t)},expression:"mailDto.email"}})],1)],1)],1)],1)},s=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n      基础信息\n    ")]),a("Form",{attrs:{"label-width":100}},[a("Row",[a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"预定人姓名："}},[a("span",[e._v(e._s(e.order.cusName))])])],1),a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"预定人手机号："}},[a("span",[e._v(e._s(e.order.cusPhone))]),e.order.secondChannel>1?a("a",{staticStyle:{"margin-left":"10px"},on:{click:e.updatePhone}},[a("Icon",{attrs:{type:"md-create"}})],1):e._e()])],1),a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"邮箱："}},[a("span",[e._v(e._s(e._f("nullFilter")(e.order.cusMail)))])])],1),a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"支付方式："}},[a("span",[e._v(e._s(e._f("nullFilter")(e._f("payMethodFilter")(e.order.payMethod))))]),e.order.ticketBid&&e.coupon?a("Tooltip",{attrs:{theme:"light"}},[a("span",[e._v("已使用 "+e._s(e.coupon.amount)+" 元优惠券")]),a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[e._v("优惠券编码: "+e._s(e.coupon.ticketNumber))]),a("p",[e._v("优惠活动名: "+e._s(e.coupon.activityName))])])]):e._e()],1)],1)],1),a("Row",[a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"入住时段："}},[a("span",[e._v(e._s(e._f("dateFilter")(e.order.orderStartDate))+" 到 "+e._s(e._f("dateFilter")(e.order.orderEndDate)))])])],1),a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"预定床位数："}},[a("Tag",{attrs:{color:"blue"}},[e._v(e._s(e.order.orderBedCount)+" 个")])],1)],1),a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"订单来源："}},[a("span",[e._v(e._s(e.channelFormat(e.order.secondChannel)))])])],1),a("Col",{attrs:{span:6}},[a("FormItem",{attrs:{label:"允许续住："}},[a("span",[e._v("否")])])],1)],1),5===e.order.orderStatus?a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.prePay}},[e._v("支 付")]):e._e(),5===e.order.orderStatus?a("Button",{staticClass:"my-btn",attrs:{type:"warning"},on:{click:e.cancelOrder}},[e._v("取 消")]):e._e(),1===e.order.orderStatus?a("Button",{staticClass:"my-btn",attrs:{type:"warning"},on:{click:e.closeOrder}},[e._v("取 消")]):e._e(),8===e.order.orderStatus||9===e.order.orderStatus||10===e.order.orderStatus?a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:function(t){e.toRefundDetail(e.order.orderBid)}}},[e._v("取消详情")]):e._e()],1),a("Modal",{attrs:{loading:e.loading,title:"支付订单",width:"500"},on:{"on-ok":e.pay},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("Form",{ref:"payForm",attrs:{model:e.paramDto,"label-width":60}},[a("FormItem",{attrs:{label:"支付方式"}},[a("Select",{staticClass:"my-select",attrs:{placeholder:""},model:{value:e.paramDto.payMethod,callback:function(t){e.$set(e.paramDto,"payMethod",t)},expression:"paramDto.payMethod"}},e._l(e.finSettleOptions,function(e){return a("Option",{key:e.payMethod,attrs:{label:e.settleName,value:e.payMethod}})}))],1),a("FormItem",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",placeholder:"",row:2,maxlength:200},model:{value:e.paramDto.remark,callback:function(t){e.$set(e.paramDto,"remark","string"===typeof t?t.trim():t)},expression:"paramDto.remark"}})],1)],1)],1),a("Modal",{attrs:{loading:e.loading,title:"取消订单",width:"500"},on:{"on-ok":e.handleCloseOrder},model:{value:e.cancelVisible,callback:function(t){e.cancelVisible=t},expression:"cancelVisible"}},[a("Form",{ref:"closeForm",attrs:{model:e.closeDto,"label-width":60}},[a("FormItem",{attrs:{label:"原因"}},[a("Select",{staticClass:"my-select",attrs:{placeholder:""},model:{value:e.closeDto.refundReason,callback:function(t){e.$set(e.closeDto,"refundReason",t)},expression:"closeDto.refundReason"}},e._l(e.closeOptions,function(e){return a("Option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),a("FormItem",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",placeholder:"",row:2,maxlength:200},model:{value:e.closeDto.remark,callback:function(t){e.$set(e.closeDto,"remark","string"===typeof t?t.trim():t)},expression:"closeDto.remark"}})],1)],1)],1)],1)},n=[],i=(a("7514"),a("f8b7")),l={name:"baseInfoCard",props:{order:Object,coupon:Object,channel:Array},data:function(){return{finSettleOptions:[],visible:!1,cancelVisible:!1,loading:!0,paramDto:{orderBid:this.order.orderBid,payMethod:"1",amount:this.order.amountNoCoupon,remark:""},closeDto:{orderBid:this.order.orderBid,refundReason:1,remark:""},closeOptions:[{label:"改变行程",value:1},{label:"填错信息、选错床位了",value:2},{label:"到店没房了",value:3},{label:"其他",value:4}]}},methods:{cancelOrder:function(){var e=this;this.$Modal.confirm({title:"通知",content:'<p>确定取消该订单？</p><p style="color: #808695;">未支付取消，直接释放库存，无需审核</p>',onOk:function(){Object(i["b"])(e.order.orderBid).then(function(t){e.$Message.success("取消成功"),e.$emit("refresh")})},onCancel:function(){}})},channelFormat:function(e){return e?this.channel.find(function(t){return t.code===e}).text:"未知"},updatePhone:function(){this.$emit("updatePhone")},updateMail:function(){this.$emit("updateMail")},prePay:function(){2!==this.order.firstChannel?this.$Message.warning("PC端暂时不能支付APP端创建的订单，请在APP端支付"):(this.getFinSettle(),this.visible=!0)},getFinSettle:function(){var e=this;Object(i["h"])().then(function(t){e.finSettleOptions=t.body})},pay:function(){var e=this;Object(i["o"])(this.paramDto).then(function(t){e.$Message.success("支付成功"),e.visible=!1,e.$emit("refresh")}).catch(function(){e.handleError()})},handleError:function(){var e=this;setTimeout(function(){e.loading=!1,e.$nextTick(function(){e.loading=!0})},500)},closeOrder:function(){var e=this;this.$Modal.confirm({title:"通知",content:'<p>确定取消该订单？</p><p style="color: #808695;">已支付取消，不会释放库存，需要审核</p>',onOk:function(){e.cancelVisible=!0},onCancel:function(){}})},handleCloseOrder:function(){var e=this;Object(i["p"])(this.closeDto).then(function(t){e.$Message.success("取消成功"),e.cancelVisible=!1,e.toRefundDetail(e.order.orderBid)}).catch(function(){e.handleError()})},toRefundDetail:function(e){var t={name:"refundDetail",query:{orderBid:e}};this.$router.push(t)}}},d=l,c=(a("ffa7"),a("2877")),u=Object(c["a"])(d,o,n,!1,null,null,null);u.options.__file="baseInfoCard.vue";var h=u.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{"dis-hover":""}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n      入住人信息\n    ")]),a("Form",{ref:"stayPersonForm",attrs:{rules:e.rules,model:e.stayPersonDto,"label-width":100}},[e._l(e.stayPersonDto.stayPersonList,function(t,r){return a("div",{key:r,staticClass:"con-stay"},[e.guestTypeFormat(t.bid)?a("div",{staticClass:"subscript-stay"},[e._v("\n          "+e._s(e.guestTypeFormat(t.bid))+"\n        ")]):e._e(),a("Row",[a("Col",{attrs:{span:22}},[a("Row",[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"姓名",prop:"name"}},[a("Input",{attrs:{type:"text",placeholder:"",clearable:""},model:{value:t.name,callback:function(a){e.$set(t,"name","string"===typeof a?a.trim():a)},expression:"item.name"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"性别",prop:"sex"}},[a("RadioGroup",{model:{value:t.sex,callback:function(a){e.$set(t,"sex",a)},expression:"item.sex"}},[a("Radio",{attrs:{label:1}},[e._v("男")]),a("Radio",{attrs:{label:2}},[e._v("女")])],1)],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"入住房型"}},[a("span",[e._v(e._s(t.houseTypeName))])])],1)],1),a("Row",[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"证件类型",prop:"credentialType"}},[a("Select",{attrs:{placeholder:"",transfer:""},model:{value:t.credentialType,callback:function(a){e.$set(t,"credentialType",a)},expression:"item.credentialType"}},e._l(e.cardTypeOptions,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label)+"\n                    ")])}))],1)],1),a("Col",{attrs:{span:8}},[1===t.credentialType?a("FormItem",{attrs:{label:"证件号",prop:"stayPersonList."+r+".credentialNumber",rules:[{required:!0,message:"请输入身份证号",trigger:"blur"},{pattern:/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|30|31)|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}([0-9]|x|X)$/,message:"身份证号码格式不对",trigger:"blur"}]}},[a("Input",{attrs:{type:"text",placeholder:"",clearable:""},model:{value:t.credentialNumber,callback:function(a){e.$set(t,"credentialNumber","string"===typeof a?a.trim():a)},expression:"item.credentialNumber"}})],1):e._e(),a("div",[1!==t.credentialType?a("FormItem",{attrs:{label:"证件号"}},[a("Input",{attrs:{type:"text",placeholder:"",clearable:""},model:{value:t.credentialNumber,callback:function(a){e.$set(t,"credentialNumber","string"===typeof a?a.trim():a)},expression:"item.credentialNumber"}})],1):e._e()],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"手机号"}},[a("Input",{attrs:{type:"text",placeholder:"",clearable:""},model:{value:t.phone,callback:function(a){e.$set(t,"phone","string"===typeof a?a.trim():a)},expression:"item.phone"}})],1)],1)],1)],1),t.guestFid?a("Col",{staticClass:"other-col",attrs:{span:2}},[a("Tooltip",{attrs:{content:"查看客史详情",placement:"left"}},[a("Button",{attrs:{shape:"circle",icon:"ios-person"},on:{click:function(t){e.openGuest(r)}}})],1)],1):e._e()],1)],1)}),1===e.orderStatus||2===e.orderStatus?a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.validateForm}},[e._v("保 存")]):e._e(),2===e.orderStatus?a("Button",{staticClass:"my-btn",attrs:{type:"primary",ghost:""},on:{click:function(t){e.guestVisible=!0}}},[e._v("客史记录")]):e._e()],2)],1),a("Modal",{attrs:{title:e.title,width:"800","footer-hide":""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?a("guest-tabs",{attrs:{"guest-fid":e.guestFid,active:e.active},on:{close:e.handleClose}}):e._e()],1),a("Modal",{attrs:{title:"客史信息搜集",width:"900","footer-hide":""},model:{value:e.guestVisible,callback:function(t){e.guestVisible=t},expression:"guestVisible"}},[e.guestVisible?a("guest-info-collect-list",{attrs:{"order-bid":e.orderBid}}):e._e()],1)],1)},f=[],m=(a("7f7f"),a("ac6a"),a("c5f6"),a("6942")),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"full-top"},[e.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):e._e(),e.showData?e._l(e.guestList,function(t,r){return a("guest-info-collect-card",{key:r,attrs:{guest:t,"channel-options":e.channelOptions,"purpose-options":e.purposeOptions,"area-options":e.areaOptions},on:{fresh:e.listGuestInfo}})}):a("div",{staticClass:"no-data"},[e._v("请保存该订单所有顾客身份证信息")])],2)},g=[],v=a("8b2d"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",{attrs:{"dis-hover":""}},[a("Form",{attrs:{model:e.paramDto,"label-width":70}},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"顾客: "}},[e._v("\n          "+e._s(e.guest.guestName)+"\n        ")])],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"床位: "}},[e._v("\n          "+e._s(e.guest.bedInfo)+"\n        ")])],1)],1),a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"获知渠道"}},[a("Select",{attrs:{placeholder:"",clearable:""},model:{value:e.paramDto.channelCode,callback:function(t){e.$set(e.paramDto,"channelCode",t)},expression:"paramDto.channelCode"}},e._l(e.channelOptions,function(e){return a("Option",{key:e.dicCode,attrs:{label:e.showName,value:e.dicCode}})}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"到达目的"}},[a("Select",{attrs:{placeholder:"",clearable:""},model:{value:e.paramDto.purposeCode,callback:function(t){e.$set(e.paramDto,"purposeCode",t)},expression:"paramDto.purposeCode"}},e._l(e.purposeOptions,function(e){return a("Option",{key:e.dicCode,attrs:{label:e.showName,value:e.dicCode}})}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"印象深刻"}},[a("Select",{attrs:{placeholder:"",clearable:""},model:{value:e.paramDto.areaCode,callback:function(t){e.$set(e.paramDto,"areaCode",t)},expression:"paramDto.areaCode"}},e._l(e.areaOptions,function(e){return a("Option",{key:e.dicCode,attrs:{label:e.showName,value:e.dicCode}})}))],1)],1)],1),a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"意见建议"}},[a("Input",{attrs:{type:"textarea",placeholder:"",row:2,maxlength:200},model:{value:e.paramDto.suggest,callback:function(t){e.$set(e.paramDto,"suggest","string"===typeof t?t.trim():t)},expression:"paramDto.suggest"}})],1)],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.saveGuestInfo}},[e._v("保 存")])],1)],1)],1)},B=[],k=(a("cadf"),a("551c"),a("097d"),{name:"guestInfoCollectCard",props:{guest:Object,channelOptions:Array,purposeOptions:Array,areaOptions:Array},data:function(){return{paramDto:{areaCode:"",areaName:"",bedInfo:"",channelCode:"",channelName:"",checkInDate:"",guestFid:"",guestName:"",orderBid:"",orderNumber:"",purposeCode:"",purposeName:"",suggest:""}}},methods:{init:function(){this.paramDto.areaCode=this.guest.areaCode,this.paramDto.areaName=this.guest.areaName,this.paramDto.bedInfo=this.guest.bedInfo,this.paramDto.channelCode=this.guest.channelCode,this.paramDto.channelName=this.guest.channelName,this.paramDto.checkInDate=this.guest.checkInDate,this.paramDto.guestFid=this.guest.guestFid,this.paramDto.guestName=this.guest.guestName,this.paramDto.orderBid=this.guest.orderBid,this.paramDto.orderNumber=this.guest.orderNumber,this.paramDto.purposeCode=this.guest.purposeCode,this.paramDto.purposeName=this.guest.purposeName,this.paramDto.suggest=this.guest.suggest},saveGuestInfo:function(){var e=this;this.fillDto(),Object(v["j"])(this.paramDto).then(function(){e.$Message.success("保存成功"),e.$emit("fresh")})},fillDto:function(){var e=this;this.paramDto.channelCode&&(this.paramDto.channelName=this.channelOptions.find(function(t){return t.dicCode===e.paramDto.channelCode}).showName),this.paramDto.purposeCode&&(this.paramDto.purposeName=this.purposeOptions.find(function(t){return t.dicCode===e.paramDto.purposeCode}).showName),this.paramDto.areaCode&&(this.paramDto.areaName=this.areaOptions.find(function(t){return t.dicCode===e.paramDto.areaCode}).showName)}},watch:{guest:{handler:function(){this.init()},deep:!0}},created:function(){this.init()}}),D=k,_=(a("7f54"),Object(c["a"])(D,y,B,!1,null,"64b4acff",null));_.options.__file="guestInfoCollectCard.vue";var C=_.exports,P={name:"guestInfoCollectList",components:{guestInfoCollectCard:C},props:{orderBid:String},data:function(){return{loading:!1,showData:!1,channelOptions:[],purposeOptions:[],areaOptions:[],guestList:[]}},methods:{collectGuestInfo:function(){var e=this;this.loading=!0,Object(v["c"])(this.orderBid).then(function(t){e.loading=!1,e.showData=t.body.showData,e.showData&&e.listGuestInfo(),e.channelOptions=t.body.channelDicList,e.purposeOptions=t.body.purposeDicDtoList,e.areaOptions=t.body.areaDicList}).catch(function(){e.loading=!1})},listGuestInfo:function(){var e=this;this.loading=!0,Object(v["g"])(this.orderBid).then(function(t){e.showData=t.body.showData,e.guestList=t.body.localDtos,e.loading=!1}).catch(function(){e.loading=!1})}},created:function(){this.collectGuestInfo()}},w=P,O=(a("e647"),Object(c["a"])(w,b,g,!1,null,"8ede14e4",null));O.options.__file="guestInfoCollectList.vue";var I=O.exports,S={name:"stayPersonCard",components:{guestTabs:m["a"],guestInfoCollectList:I},props:{stayList:{type:Array,default:function(){return[]}},guestType:Object,orderBid:String,orderStatus:Number},data:function(){return{stayPersonDto:{orderId:"",stayPersonList:[]},cardTypeOptions:[{label:"身份证",value:1},{label:"护照",value:2},{label:"其他",value:0}],title:"",visible:!1,guestFid:"",active:"record",rules:{},guestVisible:!1}},methods:{initData:function(){var e=this;this.stayPersonDto.stayPersonList=[],this.stayPersonDto.orderId=this.orderBid,this.stayList.forEach(function(t){e.stayPersonDto.stayPersonList.push({bid:t.bid,orderBid:e.orderBid,name:t.name,sex:t.sex,credentialType:t.credentialType,credentialNumber:t.credentialNumber,phone:t.phone,houseTypeName:t.houseTypeName})})},openGuest:function(e){this.title="客史详情 - ".concat(this.stayPersonDto.stayPersons[e].name),this.visible=!0,this.guestFid=this.stayPersonDto.stayPersons[e].guestFid},handleClose:function(){this.visible=!1},guestTypeFormat:function(e){return this.guestType[e]},validateForm:function(){var e=this;this.$refs.stayPersonForm.validate(function(t){if(!t)return!1;e.save()})},save:function(){this.$emit("save",this.stayPersonDto)}},watch:{data:function(){this.initData()}},created:function(){this.initData()}},$=S,L=(a("332b"),Object(c["a"])($,p,f,!1,null,"44ba8371",null));L.options.__file="stayPersonCard.vue";var x=L.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{"dis-hover":""}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("订单备注")]),a("Input",{staticClass:"remark-cls",attrs:{type:"text",maxlength:50,placeholder:"输入备注 最多50字",clearable:""},model:{value:e.orderRemark,callback:function(t){e.orderRemark="string"===typeof t?t.trim():t},expression:"orderRemark"}}),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",disabled:!e.orderRemark},on:{click:e.saveOrderRemark}},[e._v("保 存")]),a("Divider",{attrs:{dashed:""}}),a("Timeline",{attrs:{pending:e.isPending}},[e._l(e.remarks,function(t,r){return r<2?a("TimelineItem",{key:r},[a("p",{staticClass:"time"},[e._v(e._s(t.operContent))]),a("p",{staticClass:"content"},[e._v(e._s(t.operator)+" · "+e._s(t.operTime))])]):e._e()}),e.isPending?a("TimelineItem",[a("a",{attrs:{href:"#"},on:{click:function(t){e.visible=!0}}},[e._v("查看更多")])]):e._e()],2)],1),a("Modal",{attrs:{title:"订单备注","footer-hide":""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{style:{paddingLeft:"20px"}},[a("Timeline",e._l(e.remarks,function(t,r){return a("TimelineItem",{key:r},[a("p",{staticClass:"time"},[e._v(e._s(t.operContent))]),a("p",{staticClass:"content"},[e._v(e._s(t.operator)+" · "+e._s(t.operTime))])])}))],1)])],1)},T=[],N={name:"orderRemarkCard",props:{remarks:Array},data:function(){return{orderRemark:"",visible:!1}},computed:{isPending:function(){return this.remarks.length>2}},methods:{saveOrderRemark:function(){this.$emit("save",this.orderRemark)},clear:function(){this.orderRemark=""}}},M=N,j=(a("b937"),Object(c["a"])(M,F,T,!1,null,"10d99391",null));j.options.__file="orderRemarkCard.vue";var R=j.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("订单操作")]),a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:20}},[Object.keys(e.order).length?a("bed-card",{ref:"bedCard",attrs:{"bed-list":e.order.bedList,"order-bid":e.order.orderBid,"order-status":e.order.orderStatus,"start-date":e.order.orderStartDate,"end-date":e.order.orderEndDate},on:{selectBed:e.selectBed,unbindBed:e.handleUnbindBed,cancelBookBed:e.handleCancelBookBed,checkIn:e.handleCheckIn,checkOut:e.handleCheckOut}}):e._e(),1!==e.order.stayPersonSaveStats&&6!==e.order.stayPersonStats||1!==e.order.orderStatus?e._e():a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.saveBed}},[e._v("保存床位\n      ")]),1===e.order.orderStatus?[a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.checkIn}},[e._v("办理入住")]),a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.changeBed}},[e._v("调换床位")]),a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.unbindBed}},[e._v("解绑床位")]),a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.cancelBookBed}},[e._v("退订床位")])]:e._e(),2===e.order.orderStatus?[a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.checkOut}},[e._v("办理退租")]),a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.changeBed}},[e._v("调换床位")]),a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.unbindBed}},[e._v("解绑床位")])]:e._e(),6===e.order.orderStatus||11===e.order.orderStatus?[a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.toRefundDetail}},[e._v("退房详情")])]:e._e(),e.hasCheckIn?[e.lockPwdList.length?e._e():a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.generateLockPwd}},[e._v("生成密码")]),e.lockPwdList.length&&e.lockPwdHave2?a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.generateLockPwd}},[e._v("生成密码")]):e._e(),e.lockPwdList.length&&e.lockPwdHave1?[a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.showPwd}},[e._v("查看密码")]),a("Button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.sendDoorPwd}},[e._v("发送密码")])]:e._e()]:e._e()],2),a("Col",{attrs:{span:4}},[a("fee-card",{attrs:{order:e.order}})],1)],1),a("Modal",{attrs:{title:"选择床位",width:"800",loading:e.stockLoading},on:{"on-ok":e.saveBed},model:{value:e.stockVisible,callback:function(t){e.stockVisible=t},expression:"stockVisible"}},[a("div",{staticClass:"full-top"},[e.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):e._e(),e.stockData.length?a("Form",{attrs:{"label-width":70}},[a("RadioGroup",{staticStyle:{width:"100%"},model:{value:e.selectAreaBed,callback:function(t){e.selectAreaBed=t},expression:"selectAreaBed"}},e._l(e.stockData,function(t){return a("FormItem",{key:t.bid,attrs:{label:t.showName}},[a("Row",e._l(t.aresBedList,function(r){return a("Col",{key:r.bid,staticStyle:{"text-align":"center"},attrs:{span:24/t.aresBedList.length}},[a("Radio",{staticClass:"my-radio",attrs:{label:t.bid+","+r.bid,disabled:1!==r.status}},[e._v("\n                  "+e._s(e._f("bedCodeFilter")(r.bedCode))+"\n                ")])],1)}))],1)}))],1):a("div",{staticClass:"no-data"},[e._v("暂无数据")])],1)]),a("Modal",{attrs:{title:"房间密码",width:"300"},model:{value:e.pwdVisible,callback:function(t){e.pwdVisible=t},expression:"pwdVisible"}},[a("Table",{attrs:{stripe:"",columns:e.pwdColumns,data:e.lockPwdList}})],1)],1)},A=[],E=(a("28a5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",{attrs:{"dis-hover":"",bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n    床位分配\n  ")]),a("div",{attrs:{slot:"extra"},slot:"extra"},[a("Checkbox",{attrs:{indeterminate:e.indeterminate,value:e.checkAll},nativeOn:{click:function(t){return t.preventDefault(),e.handleCheckAll(t)}}},[e._v("全选\n    ")])],1),e._l(e.bedDto.stayPersonList,function(t,r){return a("Row",{key:r,staticClass:"bed-row",class:e.bedRow(r)},[a("Col",{attrs:{span:5}},[e._v("\n      入住人："+e._s(t.stayPersonName)+"\n    ")]),a("Col",{attrs:{span:4}},[e._v("\n      房型信息："+e._s(t.houseTypeParentName)+" - "+e._s(t.houseTypeName)+"\n    ")]),a("Col",{attrs:{span:4}},[e._v("\n      楼栋："+e._s(e.buildingFormat(t))+"\n    ")]),a("Col",{attrs:{span:4}},[e._v("\n      房间号："+e._s(t.areaName?t.areaName:"-")+"\n    ")]),a("Col",{attrs:{span:4}},[e._v("\n      床位号：\n      "),t.bedCode?a("span",[e._v(e._s(e._f("bedCodeFilter")(t.bedCode)))]):[1!==t.stayPersonStatus&&6!==t.stayPersonStatus?a("span",{staticStyle:{color:"#ed4014"}},[e._v("已解绑床位")]):a("span",[e._v("暂未排床")])]],2),a("Col",{attrs:{span:2}},[1===e.orderStatus||2===e.orderStatus||6===e.orderStatus||11===e.orderStatus?a("div",[1!==t.stayPersonStatus&&6!==t.stayPersonStatus?a("Tag",{attrs:{color:"blue"}},[e._v("\n          "+e._s(e._f("stayPersonStatusFilter")(t.stayPersonStatus))+"\n        ")]):a("a",{on:{click:function(a){e.selectBed(t,"first")}}},[e._v("选择床位")])],1):e._e()]),a("Col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[a("Checkbox",{on:{"on-change":e.handleCheck},model:{value:t.isSelect,callback:function(a){e.$set(t,"isSelect",a)},expression:"item.isSelect"}})],1)],1)})],2)}),q=[],z=a("90de"),G={name:"bedCard",props:{bedList:{type:Array,default:function(){return[]}},orderBid:String,orderStatus:Number,startDate:Number,endDate:Number},data:function(){return{bedDto:{orderId:"",startDate:"",endDate:"",stayPersonList:[]},checkAll:!0,indeterminate:!1}},methods:{initData:function(){var e=this;this.bedDto.stayPersonList=[],this.bedDto.orderId=this.orderBid,this.bedDto.startDate=Object(z["d"])(this.startDate,"date"),this.bedDto.endDate=Object(z["d"])(this.endDate,"date"),this.bedList.forEach(function(t){e.bedDto.stayPersonList.push({orderBid:e.orderBid,bid:t.stayPersonBid,areaBedBid:t.bedBid,houseTypeBid:t.houseTypeBid,areaBid:t.areaBid,areaCode:t.areaName,bedCode:t.bedCode,stayPersonName:t.stayPersonName,houseTypeParentName:t.houseTypeParentName,houseTypeName:t.houseTypeName,buildName:t.buildName,areaName:t.areaName,stayPersonStatus:t.stayPersonStatus,isSelect:!0})})},bedRow:function(e){if(e>0)return"bed-row-not-first"},buildingFormat:function(e){return e.buildName?e.buildName:"-"},handleCheck:function(){var e=this.bedDto.stayPersonList.filter(function(e){return e.isSelect});e.length===this.bedDto.stayPersonList.length?(this.indeterminate=!1,this.checkAll=!0):e.length>0?(this.indeterminate=!0,this.checkAll=!1):(this.indeterminate=!1,this.checkAll=!1)},handleCheckAll:function(){this.indeterminate?this.checkAll=!1:this.checkAll=!this.checkAll,this.indeterminate=!1,this.checkAll?this.bedDto.stayPersonList.forEach(function(e){e.isSelect=!0}):this.bedDto.stayPersonList.forEach(function(e){e.isSelect=!1})},saveBed:function(){var e=this,t=this.bedDto.stayPersonList.filter(function(e){return e.isSelect}),a=!0;t.forEach(function(t){t.areaBedBid||(e.$Message.warning("".concat(t.stayPersonName," 还未分配床位")),a=!1)}),a&&this.$emit("saveBed",{orderId:this.bedDto.orderId,startDate:this.bedDto.startDate,endDate:this.bedDto.endDate,stayPersonList:t})},selectBed:function(e,t){var a="",r=new Date(this.bedDto.startDate),s=new Date(this.bedDto.endDate),o=new Date(Object(z["d"])(new Date,"date"));if(o.getTime()<=r.getTime())a=this.bedDto.startDate;else if(o.getTime()<s.getTime())a=Object(z["d"])(o,"date");else{if(o.getTime()!==s.getTime())return void this.$Message.warning("订单已经结束");o.setDate(o.getDate()-1),a=Object(z["d"])(o,"date")}this.$emit("selectBed",{checkInTime:a,checkOutTime:this.bedDto.endDate,houseTypeBid:e.houseTypeBid},e,t)},unbindBed:function(){var e=this.bedDto.stayPersonList.filter(function(e){return e.isSelect});if(e.length){var t={orderBid:this.orderBid,stayPersonBidList:[],bedBidList:[],areaBidList:[]};e.forEach(function(e){t.stayPersonBidList.push(e.bid),t.bedBidList.push(e.areaBedBid),t.areaBidList.push(e.areaBid)}),this.$emit("unbindBed",t)}else this.$Message.warning("请至少选择一个床位")},changeBed:function(){var e=this.bedDto.stayPersonList.filter(function(e){return e.isSelect});if(e.length)if(e.length>1)this.$Message.warning("只能选择一个床位");else{var t=e[0];4===t.stayPersonStatus?this.$Message.warning("已退租床位不能调换床位"):t.areaBedBid||1!==t.stayPersonStatus&&6!==t.stayPersonStatus?this.selectBed(t,"second"):this.$Message.warning("当前入住人还未排床，请先排床")}else this.$Message.warning("请选择一个床位")},cancelBookBed:function(){var e=this.bedDto.stayPersonList.filter(function(e){return e.isSelect});if(e.length){var t=e.filter(function(e){return 2===e.stayPersonStatus||8===e.stayPersonStatus||9===e.stayPersonStatus||10===e.stayPersonStatus});if(t.length)return void this.$Message.warning("已取消 或 已入住 的床位不能退订");var a={orderBid:this.orderBid,stayPersonBidList:[]};e.forEach(function(e){a.stayPersonBidList.push(e.bid)}),this.$emit("cancelBookBed",a)}else this.$Message.warning("请至少选择一个床位")},checkIn:function(){var e=this.bedDto.stayPersonList.filter(function(e){return e.isSelect});if(e.length){var t=e.filter(function(e){return 8===e.stayPersonStatus||9===e.stayPersonStatus||10===e.stayPersonStatus});if(t.length)return void this.$Message.warning("退订床位不能办理入住");var a=e.filter(function(e){return!e.areaBedBid});if(a.length)return void this.$Message.warning("入住床位不能为空，请先排床");var r={orderBid:this.orderBid,stayPersonBidList:[],customerPhone:""};e.forEach(function(e){r.stayPersonBidList.push(e.bid)}),this.$emit("checkIn",r)}else this.$Message.warning("请至少选择一个床位")},checkOut:function(){var e=this.bedDto.stayPersonList.filter(function(e){return e.isSelect});if(e.length){var t=e.filter(function(e){return 4===e.stayPersonStatus});if(t.length)return void this.$Message.warning("已退租床位不能再次退租");var a=e.filter(function(e){return 8===e.stayPersonStatus||9===e.stayPersonStatus||10===e.stayPersonStatus});if(a.length)return void this.$Message.warning("退订床位不能办理退租");var r=e.filter(function(e){return!e.areaBedBid});if(r.length)return void this.$Message.warning("入住床位不能为空，请先排");var s={orderBid:this.orderBid,stayPersonBidList:[],areaBedBidList:[],customerPhone:""};e.forEach(function(e){s.stayPersonBidList.push(e.bid),s.areaBedBidList.push(e.areaBedBid)}),this.$emit("checkOut",s)}else this.$Message.warning("请至少选择一个床位")}},watch:{bedList:function(){this.initData()}},created:function(){this.initData()}},H=G,W=(a("3436"),Object(c["a"])(H,E,q,!1,null,"cee5918c",null));W.options.__file="bedCard.vue";var J=W.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{"dis-hover":"",bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n      费用项目\n    ")]),e.hasDep?e._e():a("a",{attrs:{slot:"extra"},on:{click:function(t){t.preventDefault(),e.visible=!0}},slot:"extra"},[a("Icon",{attrs:{type:"ios-add-circle-outline"}}),e._v("\n      添加\n    ")],1),e._l(e.feeList,function(t,r){return e.hasDep?a("Row",{key:r,staticClass:"fee-row",class:e.feeRow(r),attrs:{gutter:10}},[a("Col",{attrs:{span:8}},[a("Tag",{attrs:{color:"blue"}},[e._v(e._s(e._f("paymentTypeFilter")(t.depPaymentType)))])],1),a("Col",{attrs:{span:8}},[a("strong",[e._v("¥ "+e._s(t.depositSum))])]),a("Col",{attrs:{span:8}},[2!==t.depositStatus?a("a",{style:{color:"#2d8cf0"}},[e._v("退还")]):a("span",[e._v("已退还")])])],1):e._e()}),e.hasDep?e._e():a("div",{staticClass:"no-data"},[e._v("暂无数据")])],2),a("Modal",{attrs:{title:"添加费用项目"},on:{"on-ok":e.saveFee},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?a("Form",{ref:"feeForm",attrs:{model:e.feeDto,rules:e.feeRules,"label-width":50}},[a("FormItem",{attrs:{label:"项目",prop:"type"}},[a("Select",{attrs:{placeholder:""},model:{value:e.feeDto.type,callback:function(t){e.$set(e.feeDto,"type",t)},expression:"feeDto.type"}},e._l(e.typeOptions,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("FormItem",{attrs:{label:"金额",prop:"money"}},[a("Input",{attrs:{type:"text",palceholder:"请输入金额"},model:{value:e.feeDto.money,callback:function(t){e.$set(e.feeDto,"money","string"===typeof t?t.trim():t)},expression:"feeDto.money"}})],1)],1):e._e()],1)],1)},X=[],K={name:"feeCard",props:{order:Object},data:function(){return{feeList:[],feeDto:{depPaymentType:1,depositSum:""},feeRules:{type:[{required:!0,message:"请选择费用项目",trigger:"change"}],money:[{required:!0,message:"请输入金额",trigger:"blur"},{type:"number",min:0,max:200,message:"金额介于 0～200",trigger:"blur"}]},typeOptions:[{label:"押金",value:1}],visible:!1}},computed:{hasDep:function(){return this.feeList.length>0}},methods:{initData:function(){this.order.depPaymentType&&(this.feeList=[],this.feeList.push({orderBid:this.order.orderBid,depPaymentType:this.order.depPaymentType,depositSum:this.order.depositSum,depositStatus:this.order.depositStatus}))},saveFee:function(){},listFee:function(){},feeRow:function(e){if(e>0)return"fee-row-not-first"}},watch:{order:function(){this.initData()}},created:function(){this.initData()},filters:{paymentTypeFilter:function(e){switch(e){case 1:return"押金"}}}},Q=K,Y=(a("93bd"),Object(c["a"])(Q,U,X,!1,null,"c3c1e91a",null));Y.options.__file="feeCard.vue";var Z=Y.exports,ee=a("d43b"),te=a("4361"),ae={name:"orderActionCard",props:{order:Object,hasCheckIn:Boolean,lockPwdList:{type:Array,default:function(){return[]}},lockPwdHave1:Boolean,lockPwdHave2:Boolean},components:{bedCard:J,feeCard:Z},data:function(){return{loading:!1,stockVisible:!1,stockLoading:!0,stockData:[],selectAreaBed:"",type:"",changeBedDto:{orderBid:"",stayPersonBid:"",oldBedBid:"",oldAreaBid:"",houseTypeBid:"",startDate:"",endDate:"",newBedBid:"",newAreaBid:"",projectBid:""},saveBedDto:{orderBid:"",startDate:"",endDate:"",stayPersonList:[{orderBid:"",bid:"",houseTypeBid:"",areaBid:"",areaBedBid:""}]},pwdVisible:!1,pwdColumns:[{title:"房间",key:"areCode",align:"center"},{title:"密码",key:"passWord",align:"center"}]}},methods:{selectBed:function(e,t,a){this.stockVisible=!0,this.selectAreaBed="",this.getStock(e),"first"===a?(this.type="first",this.saveBedDto.orderBid=t.orderBid,this.saveBedDto.startDate=e.checkInTime,this.saveBedDto.endDate=e.checkOutTime,this.saveBedDto.stayPersonList[0].orderBid=t.orderBid,this.saveBedDto.stayPersonList[0].bid=t.bid,this.saveBedDto.stayPersonList[0].houseTypeBid=t.houseTypeBid):(this.type="second",this.changeBedDto.orderBid=t.orderBid,this.changeBedDto.stayPersonBid=t.bid,this.changeBedDto.oldBedBid=t.areaBedBid,this.changeBedDto.oldAreaBid=t.areaBid,this.changeBedDto.houseTypeBid=t.houseTypeBid,this.changeBedDto.startDate=e.checkInTime,this.changeBedDto.endDate=e.checkOutTime,this.changeBedDto.newBedBid="",this.changeBedDto.newAreaBid="",this.changeBedDto.projectBid=this.order.projectBid)},changeBed:function(){this.$refs.bedCard.changeBed()},getStock:function(e){var t=this;this.loading=!0,Object(ee["c"])(e).then(function(e){t.stockData=e.body,t.loading=!1}).catch(function(){t.loading=!1})},saveBed:function(){"first"===this.type?this.firstSaveBed():this.secondSaveBed()},secondSaveBed:function(){var e=this;Object(i["c"])(this.changeBedDto).then(function(){e.$Message.success("床位保存成功"),e.stockVisible=!1,e.$emit("refresh")}).catch(function(){e.handleError()})},firstSaveBed:function(){var e=this;Object(i["s"])(this.saveBedDto).then(function(){e.$Message.success("床位保存成功"),e.stockVisible=!1,e.$emit("refresh")}).catch(function(){e.handleError()})},handleError:function(){var e=this;setTimeout(function(){e.stockLoading=!1,e.$nextTick(function(){e.stockLoading=!0})},500)},unbindBed:function(){this.$refs.bedCard.unbindBed()},handleUnbindBed:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要解绑吗？</p>",onOk:function(){Object(i["u"])(e).then(function(e){t.$Message.success("床位解绑成功"),t.$emit("refresh")})},onCancel:function(){}})},checkIn:function(){this.$refs.bedCard.checkIn()},handleCheckIn:function(e){var t=this,a=this.order.cusPhone;/^\d{11}$/.test(a)?(e.customerPhone=a,Object(i["d"])(e).then(function(e){t.$Message.success("办理入住成功"),t.$emit("refresh")})):this.$Message.warning("预定人手机号格式不正确")},cancelBookBed:function(){this.$refs.bedCard.cancelBookBed()},handleCancelBookBed:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要退订床位吗？</p>",onOk:function(){Object(i["a"])(e).then(function(e){t.$Message.success("退订床位成功"),t.$emit("refresh")})},onCancel:function(){}})},checkOut:function(){this.$refs.bedCard.checkOut()},handleCheckOut:function(e){var t=this;e.customerPhone=this.order.cusPhone,Object(i["e"])(e).then(function(e){t.$Message.success("办理退租成功"),t.$emit("refresh")})},generateLockPwd:function(){var e=this;this.$Modal.confirm({title:"通知",content:"<p>确定生成密码吗？</p>",onOk:function(){Object(i["f"])({orderBid:e.order.orderBid,projectBid:e.order.projectBid}).then(function(t){e.$Message.success("密码生成成功"),e.$emit("refresh")})},onCancel:function(){}})},showPwd:function(){this.pwdVisible=!0,Object(te["b"])(this.order.orderBid)},sendDoorPwd:function(){var e=this;Object(te["i"])(this.order.orderBid).then(function(t){e.$Message.success("密码发送成功")})},toRefundDetail:function(){var e=this.order.orderBid,t={name:"refundDetail",query:{orderBid:e}};this.$router.push(t)}},watch:{selectAreaBed:function(e){if(e){var t=e.split(",");this.changeBedDto.newAreaBid=t[0],this.changeBedDto.newBedBid=t[1],this.saveBedDto.stayPersonList[0].areaBid=t[0],this.saveBedDto.stayPersonList[0].areaBedBid=t[1]}else this.changeBedDto.newAreaBid="",this.changeBedDto.newBedBid="",this.saveBedDto.stayPersonList[0].areaBid="",this.saveBedDto.stayPersonList[0].areaBedBid=""}}},re=ae,se=(a("2684"),Object(c["a"])(re,V,A,!1,null,"5ea84752",null));se.options.__file="orderActionCard.vue";var oe=se.exports,ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"full-top"},[e.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):e._e(),a("Timeline",e._l(e.orderLog,function(t,r){return a("TimelineItem",{key:r},[a("p",{staticClass:"content"},[e._v(e._s(t.operContent))]),a("p",{staticClass:"time"},[e._v(e._s(t.operator)+" · "+e._s(t.operTime))])])}))],1)},ie=[],le={name:"orderLog",props:{orderBid:String},data:function(){return{orderLog:[],loading:!1}},methods:{getOrderRecord:function(){var e=this;this.loading=!0,Object(i["j"])(this.orderBid).then(function(t){e.orderLog=t.body,e.loading=!1}).catch(function(){e.loading=!1})}},created:function(){this.getOrderRecord()}},de=le,ce=(a("a219"),Object(c["a"])(de,ne,ie,!1,null,"532c44ea",null));ce.options.__file="orderLog.vue";var ue=ce.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Table",{attrs:{stripe:"",columns:e.columns,data:e.paymentDetail,loading:e.loading},scopedSlots:e._u([{key:"paymentDate",fn:function(t){var r=t.row;return[a("div",[e._v(e._s(r.orderDate))])]}},{key:"bedCode",fn:function(t){var r=t.row;return[a("div",[e._v(e._s(e._f("bedCodeFilter")(r.bedCode)))])]}},{key:"isConsume",fn:function(t){var r=t.row;return[a("div",[e._v(e._s(e._f("consumeFilter")(r.isConsume)))])]}}])}),a("Page",{staticClass:"my-page",attrs:{total:e.total,"show-total":"",current:e.paramDto.pageNum,"page-size":e.paramDto.pageSize},on:{"update:current":function(t){e.$set(e.paramDto,"pageNum",t)},"on-change":e.handlePageChange}})],1)},pe=[],fe={name:"paymentDetail",props:{orderBid:String},data:function(){return{paramDto:{orderBid:this.orderBid,pageNum:1,pageSize:10},paymentDetail:[],total:0,loading:!1,columns:[{title:"序号",type:"index",width:60},{title:"日期",slot:"paymentDate"},{title:"房型名称",key:"houseName"},{title:"床位号",slot:"bedCode"},{title:"支付金额/元",key:"bedPrice"},{title:"是否消费",slot:"isConsume"}]}},methods:{handlePageChange:function(){var e=this;this.loading=!0,Object(i["i"])(this.paramDto).then(function(t){e.paymentDetail=t.body.rows,e.total=t.body.total,e.loading=!1}).catch(function(){e.loading=!1})}},created:function(){this.paramDto.pageNum=1,this.handlePageChange()},filters:{consumeFilter:function(e){return 0===e?"消费":"未消费"}}},me=fe,be=(a("4280"),Object(c["a"])(me,he,pe,!1,null,"3a7d213a",null));be.options.__file="paymentDetail.vue";var ge=be.exports,ve={name:"orderDetail",components:{baseInfoCard:h,stayPersonCard:x,orderRemarkCard:R,orderActionCard:oe,orderLog:ue,paymentDetail:ge},data:function(){return{orderNumber:"",loading:!1,orderInfo:{},accountBank:"",lockPwdList:[],lockPwdHave1:"",lockPwdHave2:"",hasCheckInStayPerson:"",ticketInfo:"",renewOrderEndMinDate:"",recordList:[],guestType:{},firstChannel:[],logVisible:!1,paymentVisible:!1,newCusPhone:"",phoneDto:{orderBid:"",phone:"",oldPhone:""},phoneVisible:!1,mailVisible:!1,phoneLoading:!0,mailDto:{orderBid:"",email:""}}},computed:{orderStatusBC:function(){switch(this.orderInfo.orderStatus){case 1:return"#5cadff";case 2:return"#19be6b";case 3:return"#ff9900";default:return"#2d8cf0"}}},methods:{getOrderDetail:function(){var e=this;this.loading=!0,this.orderNumber=this.$route.query.orderNumber,Object(i["n"])(this.orderNumber).then(function(t){e.orderInfo=t.body.orderInfo,e.accountBank=t.body.accountBank,e.lockPwdList=t.body.lockPwdList,e.lockPwdHave1=t.body.lockPwdHave1,e.lockPwdHave2=t.body.lockPwdHave2,e.hasCheckInStayPerson=t.body.hasCheckInStayPerson,e.ticketInfo=t.body.ticketInfo,e.renewOrderEndMinDate=t.body.renewOrderEndMinDate,e.recordList=t.body.recordList,e.guestType=t.body.guestType,e.firstChannel=t.body.firstChannel,e.loading=!1}).catch(function(){e.loading=!1})},saveOrderRemark:function(e){var t=this;Object(i["r"])({orderBid:this.orderInfo.orderBid,orderRemark:e}).then(function(e){t.$Message.success("备注保存成功，备注信息稍后展示"),t.$refs.remarkRef.clear(),setTimeout(function(){t.getOrderRemark()},2e3)})},getOrderRemark:function(){var e=this;Object(i["k"])(this.orderInfo.orderBid).then(function(t){e.recordList=t.body})},saveStayPerson:function(e){var t=this;Object(i["s"])(e).then(function(){t.$Message.success("入住人保存成功"),t.getOrderDetail()})},saveBed:function(e){console.info("saveBed ",e)},updatePhone:function(){this.phoneDto.orderBid=this.orderInfo.orderBid,this.phoneDto.phone=this.orderInfo.cusPhone,this.phoneDto.oldPhone=this.orderInfo.cusPhone,this.phoneVisible=!0},validPhone:function(){var e=this;this.$refs.cusPhoneForm.validate(function(t){t?e.phoneDto.phone!==e.phoneDto.oldPhone?e.updateOrderPhone():e.phoneVisible=!1:e.handleError()})},updateOrderPhone:function(){var e=this;Object(i["v"])(this.phoneDto).then(function(t){e.$Message.success("预定手机号修改成功"),e.phoneVisible=!1,e.getOrderDetail()}).catch(function(){e.handleError()})},validMail:function(){var e=this;this.$refs.mailForm.validate(function(t){t?e.sendEmail():e.handleError()})},sendEmail:function(){var e=this;this.mailDto.orderBid=this.orderInfo.orderBid,this.$Message.info("邮件后台发送中..."),Object(i["t"])(this.mailDto).then(function(){e.$Message.success("邮件发送成功"),e.mailVisible=!1})},updateMail:function(){},handleError:function(){var e=this;setTimeout(function(){e.phoneLoading=!1,e.$nextTick(function(){e.phoneLoading=!0})},500)},printRegistrationForm:function(){this.$Message.info("入住单后台生成中，稍后在新页面打开..."),Object(i["m"])(this.orderInfo.orderBid).then(function(e){window.open(e.body,"_blank")})}},watch:{$route:function(e,t){this.getOrderDetail()}},created:function(){this.getOrderDetail()}},ye=ve,Be=(a("73bf"),Object(c["a"])(ye,r,s,!1,null,"41db1d28",null));Be.options.__file="orderDetail.vue";t["default"]=Be.exports},b937:function(e,t,a){"use strict";var r=a("955e"),s=a.n(r);s.a},c9a5:function(e,t,a){},e647:function(e,t,a){"use strict";var r=a("f6fe"),s=a.n(r);s.a},ea1e:function(e,t,a){},f6fe:function(e,t,a){},ffa7:function(e,t,a){"use strict";var r=a("3d70"),s=a.n(r);s.a}}]);