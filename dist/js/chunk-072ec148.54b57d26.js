(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-072ec148"],{"2c89":function(e,t,o){},"39cf":function(e,t,o){"use strict";var r=o("2c89"),n=o.n(r);n.a},4958:function(e,t,o){"use strict";o.d(t,"e",function(){return n}),o.d(t,"l",function(){return a}),o.d(t,"c",function(){return i}),o.d(t,"i",function(){return s}),o.d(t,"f",function(){return c}),o.d(t,"b",function(){return l}),o.d(t,"h",function(){return u}),o.d(t,"j",function(){return m}),o.d(t,"a",function(){return d}),o.d(t,"d",function(){return b}),o.d(t,"k",function(){return p}),o.d(t,"g",function(){return f});var r=o("6b6c"),n=function(e){return r["a"].request({url:"/socialContact/getGroupsByProjectBid.action",method:"post",data:e})},a=function(e){return r["a"].request({url:"/socialContact/updateGroupByGroupId.action",method:"post",data:e})},i=function(e){return r["a"].request({url:"/socialContact/createGroup.action",method:"post",data:e})},s=function(e){return r["a"].request({url:"/socialContact/removeGroupByGroupId.action",method:"post",data:e})},c=function(e){return r["a"].request({url:"/socialContact/getMembersByGroupBid.action",method:"post",data:e})},l=function(e){return r["a"].request({url:"/socialContact/addGagMember.action",method:"post",data:e})},u=function(e){return r["a"].request({url:"/socialContact/removeGagMember.action",method:"post",data:e})},m=function(e){return r["a"].request({url:"/socialContact/removeGroupMembers.action",method:"post",data:e})},d=function(e){return r["a"].request({url:"/socialContact/addAdminMember.action",method:"post",data:e})},b=function(e){return r["a"].request({url:"/socialContact/deleteAdminMember.action",method:"post",data:e})},p=function(e){return r["a"].request({url:"/socialContact/transferGroup.action",method:"post",data:e})},f=function(e){return r["a"].request({url:"/socialContact/getPhoneByUid.action",method:"get",params:{uid:e}})}},7254:function(e,t,o){"use strict";var r=o("9751"),n=o.n(r);n.a},9751:function(e,t,o){},ccb9:function(e,t,o){"use strict";var r=o("cfef"),n=o.n(r);n.a},cfef:function(e,t,o){},e3c9:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("chat-member-form",{attrs:{groupName:e.groupName},on:{search:e.listChatMember,join:e.handleJoin}}),o("Table",{staticClass:"my-table",attrs:{stripe:"",columns:e.columns,data:e.chatList,loading:e.loading},scopedSlots:e._u([{key:"userInfo",fn:function(t){var r=t.row;return[o("a",{on:{click:function(t){e.openGuest(r)}}},[e._v("查看")])]}},{key:"memberRole",fn:function(t){var r=t.row;return[o("div",[e._v(e._s(e._f("roleFilter")(r.memberRole)))])]}},{key:"memberStatus",fn:function(t){var r=t.row;return[o("div",[e._v(e._s(e._f("userStatusFilter")(r.memberStatu)))])]}},{key:"action",fn:function(t){var r=t.row;return[0===r.memberRole?[0===r.memberStatu?o("a",{staticClass:"my-btn",on:{click:function(t){e.confirmAddGagMember(r)}}},[e._v("禁言")]):o("a",{staticClass:"my-btn",on:{click:function(t){e.confirmRemoveGagMember(r)}}},[e._v("解禁")]),o("a",{staticClass:"my-btn",style:{color:"#ed4014"},on:{click:function(t){e.confirmRemoveMember(r)}}},[e._v("踢出")]),0===r.memberRole&&0===r.memberStatu?o("a",{on:{click:function(t){e.confirmAddAdminMember(r)}}},[e._v("设为管理员")]):e._e()]:1===r.memberRole?[o("a",{staticClass:"my-btn",on:{click:function(t){e.confirmDeleteAdminMember(r)}}},[e._v("取消管理员")]),o("a",{on:{click:function(t){e.confirmTransferGroup(r)}}},[e._v("成为群主")])]:[o("span",[e._v("-")])]]}}])}),o("Page",{staticClass:"my-page",attrs:{total:e.total,"show-total":"",current:e.paramDto.page,"page-size":e.paramDto.limit},on:{"update:current":function(t){e.$set(e.paramDto,"page",t)},"on-change":e.handlePageChange}}),o("Modal",{attrs:{title:"加入群聊",loading:e.joinLoading},on:{"on-ok":e.joinGroup},model:{value:e.joinVisible,callback:function(t){e.joinVisible=t},expression:"joinVisible"}},[e.joinVisible?o("Form",{ref:"joinForm",attrs:{model:e.joinDto,rules:e.joinRules,"label-width":80}},[o("FormItem",{attrs:{label:"用户手机",prop:"customerMobile"}},[o("Input",{attrs:{placeholder:"",clearable:""},model:{value:e.joinDto.customerMobile,callback:function(t){e.$set(e.joinDto,"customerMobile","string"===typeof t?t.trim():t)},expression:"joinDto.customerMobile"}})],1),o("FormItem",{attrs:{label:"用户角色",prop:"memberRole"}},[o("Select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.joinDto.memberRole,callback:function(t){e.$set(e.joinDto,"memberRole",t)},expression:"joinDto.memberRole"}},e._l(e.memberRoleOptions,function(t){return o("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1):e._e()],1),o("Modal",{attrs:{title:"用户信息",width:"800","footer-hide":""},model:{value:e.customerVisible,callback:function(t){e.customerVisible=t},expression:"customerVisible"}},[e.customerVisible?o("customer-card",{attrs:{uid:e.uid},on:{close:e.handleClose}}):e._e()],1)],1)},n=[],a=(o("f751"),o("be94")),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("Form",{ref:"chatForm",attrs:{model:e.paramDto,"label-width":100}},[o("Row",[o("Col",{attrs:{span:8}},[o("FormItem",{attrs:{label:"当前群聊"}},[o("Tag",{attrs:{color:"blue"}},[e._v(e._s(e.groupName))])],1)],1),o("Col",{attrs:{span:8}},[o("FormItem",{attrs:{label:"用户昵称"}},[o("Input",{attrs:{placeholder:"",clearable:""},model:{value:e.paramDto.nickName,callback:function(t){e.$set(e.paramDto,"nickName","string"===typeof t?t.trim():t)},expression:"paramDto.nickName"}})],1)],1),o("Col",{attrs:{span:8}},[o("FormItem",{attrs:{label:"用户手机"}},[o("Input",{attrs:{placeholder:"",clearable:""},model:{value:e.paramDto.customerMobile,callback:function(t){e.$set(e.paramDto,"customerMobile","string"===typeof t?t.trim():t)},expression:"paramDto.customerMobile"}})],1)],1)],1),o("Row",[o("Col",{attrs:{span:8}},[o("FormItem",{attrs:{label:"操作人"}},[o("Input",{attrs:{placeholder:"",clearable:""},model:{value:e.paramDto.opFid,callback:function(t){e.$set(e.paramDto,"opFid","string"===typeof t?t.trim():t)},expression:"paramDto.opFid"}})],1)],1),o("Col",{attrs:{span:8}},[o("FormItem",{attrs:{label:"用户角色"}},[o("Select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.paramDto.memberRole,callback:function(t){e.$set(e.paramDto,"memberRole",t)},expression:"paramDto.memberRole"}},e._l(e.memberRoleOptions,function(t){return o("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),o("Col",{attrs:{span:8}},[o("FormItem",{attrs:{label:"用户状态"}},[o("Select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.paramDto.memberStatus,callback:function(t){e.$set(e.paramDto,"memberStatus",t)},expression:"paramDto.memberStatus"}},e._l(e.memberStatusOptions,function(t){return o("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1),o("Row",[o("Col",{attrs:{span:"12"}},[o("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.submit}},[e._v(" 查 询")])],1),o("Col",{staticStyle:{"text-align":"right"},attrs:{span:"12"}},[o("Button",{attrs:{type:"primary"},on:{click:e.join}},[e._v("加入群聊")])],1)],1)],1)},s=[],c={name:"chatMemberForm",props:{groupName:String},data:function(){return{paramDto:{nickName:"",customerMobile:"",opFid:"",memberRole:"",memberStatus:""},memberRoleOptions:[{label:"普通成员",value:0},{label:"管理员",value:1},{label:"群主",value:2}],memberStatusOptions:[{label:"已入群",value:0},{label:"已禁言",value:1}]}},methods:{submit:function(){this.$emit("search",this.paramDto)},join:function(){this.$emit("join")}},created:function(){this.submit()}},l=c,u=(o("39cf"),o("2877")),m=Object(u["a"])(l,i,s,!1,null,"0aabea07",null);m.options.__file="chatMemberForm.vue";var d=m.exports,b=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("Form",{attrs:{model:e.customer,"label-width":50}},[o("Row",[o("Col",{attrs:{span:12}},[o("FormItem",{attrs:{label:"姓名",prop:"customerMobile"}},[e._v("\n          "+e._s(e._f("nullFilter")(e.customer.nickName))+"\n        ")])],1),o("Col",{attrs:{span:12}},[o("FormItem",{attrs:{label:"手机号",prop:"customerMobile"}},[e._v("\n          "+e._s(e._f("nullFilter")(e.customer.customerMobile))+"\n        ")])],1)],1),o("Row",[o("Col",{attrs:{span:12}},[o("FormItem",{attrs:{label:"性别",prop:"customerMobile"}},[e._v("\n          "+e._s(e._f("sexFilter")(e._f("nullFilter")(e.customer.customerSex)))+"\n        ")])],1),o("Col",{attrs:{span:12}},[o("FormItem",{attrs:{label:"证件号",prop:"customerMobile"}},[e._v("\n          "+e._s(e._f("nullFilter")(e.customer.idNo))+"\n        ")])],1)],1)],1),o("Table",{attrs:{stripe:"",columns:e.columns,data:e.orderList,loading:e.loading,"max-height":"300",size:"small"},scopedSlots:e._u([{key:"perStartDate",fn:function(t){var r=t.row;return[o("div",[e._v(e._s(e._f("dateFilter")(r.perStartDate)))])]}},{key:"perEndDate",fn:function(t){var r=t.row;return[o("div",[e._v(e._s(e._f("dateFilter")(r.perEndDate)))])]}},{key:"orderStatus",fn:function(t){var r=t.row;return[o("div",[e._v(e._s(e._f("orderStatusFilter")(r.orderStatus)))])]}}])})],1)},p=[],f=o("4958"),h={name:"customerCard",props:{uid:String},data:function(){return{customer:{},orderList:[],loading:!1,columns:[{title:"订单号码",key:"orderNumber"},{title:"入住日期",slot:"perStartDate"},{title:"退房日期",slot:"perEndDate"},{title:"订单状态",slot:"orderStatus"}]}},methods:{getCustomerInfo:function(){var e=this;this.loading=!0,Object(f["g"])(this.uid).then(function(t){e.customer=t.body.customer,e.orderList=t.body.orderList,e.loading=!1}).catch(function(){e.loading=!1})}},created:function(){this.getCustomerInfo()},filters:{sexFilter:function(e){return 1===e?"":2===e?"":e}}},g=h,v=(o("ccb9"),Object(u["a"])(g,b,p,!1,null,"f4289240",null));v.options.__file="customerCard.vue";var _=v.exports,M=o("2f62"),C={name:"chatMemberList",components:{chatMemberForm:d,customerCard:_},data:function(){return{loading:!1,groupName:"",paramDto:{groupId:"",page:1,limit:10},columns:[{title:"用户昵称",key:"memberNickName"},{title:"用户信息",slot:"userInfo"},{title:"用户角色",slot:"memberRole"},{title:"用户状态",slot:"memberStatus"},{title:"操作",slot:"action",width:200}],chatList:[],total:0,joinVisible:!1,joinLoading:!0,joinDto:{groupId:"",customerMobile:"",memberRole:""},joinRules:{customerMobile:[{required:!0,message:"请输入用户手机",trigger:"blur"},{pattern:/^1\d{10}$/,message:"手机号格式有误",trigger:"blur"}],memberRole:[{required:!0,type:"number",message:"请选择用户角色",trigger:"change"}]},memberRoleOptions:[{label:"普通成员",value:1}],customerVisible:!1,uid:""}},methods:Object(a["a"])({},Object(M["d"])(["closeTag"]),{handleCloseTag:function(){this.closeTag({name:"chatMemberList"})},listChatMember:function(e){Object.assign(this.paramDto,e),this.paramDto.page=1,this.handlePageChange()},handlePageChange:function(){var e=this;this.loading=!0,this.groupName=this.$route.query.groupName,this.paramDto.groupId=this.$route.query.groupId,this.groupName&&this.paramDto.groupId||(this.loading=!1,this.$Message.warning("请通过群列表访问群聊成员页面"),this.handleCloseTag(),this.$router.push({name:"home"})),Object(f["f"])(this.paramDto).then(function(t){e.chatList=t.body.rows,e.total=t.body.total,e.loading=!1}).catch(function(){e.loading=!1})},handleJoin:function(){this.joinDto.groupId=this.$route.query.groupId,this.joinDto.customerMobile="",this.joinDto.memberRole="",this.joinVisible=!0},joinGroup:function(){var e=this;this.$refs["joinForm"].validate(function(t){t?e.joinVisible=!1:setTimeout(function(){e.joinLoading=!1,e.$nextTick(function(){e.joinLoading=!0})},500)})},confirmAddGagMember:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要禁言 ".concat(e.memberNickName," 吗？</p>"),onOk:function(){t.addGagMember(e)},onCancel:function(){}})},addGagMember:function(e){var t=this,o={groupId:e.groupId,members:[e.member]};Object(f["b"])(o).then(function(e){t.$Message.success("禁言成功"),t.handlePageChange()})},confirmRemoveGagMember:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要解除 ".concat(e.memberNickName," 的禁言吗？</p>"),onOk:function(){t.removeGagMember(e)},onCancel:function(){}})},removeGagMember:function(e){var t=this,o={groupId:e.groupId,members:[e.member]};Object(f["h"])(o).then(function(e){t.$Message.success("解禁成功"),t.handlePageChange()})},confirmRemoveMember:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要将 ".concat(e.memberNickName," 踢出群聊吗？</p>"),onOk:function(){t.removeMember(e)},onCancel:function(){}})},removeMember:function(e){var t=this,o={groupId:e.groupId,members:[e.member]};Object(f["j"])(o).then(function(e){t.$Message.success("踢出群聊成功"),t.handlePageChange()})},confirmAddAdminMember:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要将 ".concat(e.memberNickName," 设为管理员吗？</p>"),onOk:function(){t.addAdminMember(e)},onCancel:function(){}})},addAdminMember:function(e){var t=this,o={groupId:e.groupId,members:[e.member],memberRole:1};Object(f["a"])(o).then(function(e){t.$Message.success("管理员设置成功"),t.handlePageChange()})},confirmDeleteAdminMember:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要取消 ".concat(e.memberNickName," 的管理员身份吗？</p>"),onOk:function(){t.deleteAdminMember(e)},onCancel:function(){}})},deleteAdminMember:function(e){var t=this,o={groupId:e.groupId,members:[e.member]};Object(f["d"])(o).then(function(e){t.$Message.success("管理员取消成功"),t.handlePageChange()})},confirmTransferGroup:function(e){var t=this;this.$Modal.confirm({title:"通知",content:"<p>确定要将 ".concat(e.memberNickName," 设为群主吗？</p><p>老群主将会变成普通成员</p>"),onOk:function(){t.transferGroup(e)},onCancel:function(){}})},transferGroup:function(e){var t=this,o={groupId:e.groupId,owner:e.member};Object(f["k"])(o).then(function(e){t.$Message.success("群主转移成功"),t.handlePageChange()})},openGuest:function(e){this.uid=e.member,this.customerVisible=!0},handleClose:function(){this.customerVisible=!1}}),watch:{$route:function(e,t){this.handlePageChange()}},filters:{roleFilter:function(e){return 0===e?"普通成员":1===e?"管理员":2===e?"群主":void 0},userStatusFilter:function(e){return 0===e?"已入群":1===e?"已禁言":void 0}}},k=C,j=(o("7254"),Object(u["a"])(k,r,n,!1,null,"400cbe8c",null));j.options.__file="chatMemberList.vue";t["default"]=j.exports}}]);