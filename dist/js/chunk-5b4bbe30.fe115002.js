(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b4bbe30"],{2934:function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"a",function(){return n}),r.d(e,"d",function(){return o}),r.d(e,"c",function(){return c});var a=r("6b6c"),i=function(){return a["a"].request({url:"/project/getCity.action",method:"get"})},n=function(t){return a["a"].request({url:"/project/getAreaByCity.action",method:"get",params:{cityCode:t}})},o=function(t){return a["a"].request({url:"/system/requestExportFile.action",method:"post",data:t})},c=function(t){return a["a"].request({url:"/system/getExportProcess",method:"get",params:{key:t}})}},"5b8d":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",[r("Col",{attrs:{span:18}},[r("Form",{attrs:{model:t.paramDto,"label-width":80,inline:""}},[r("FormItem",{attrs:{label:"项目"}},[r("Select",{staticClass:"my-input",attrs:{placeholder:""},model:{value:t.paramDto.projectBid,callback:function(e){t.$set(t.paramDto,"projectBid",e)},expression:"paramDto.projectBid"}},t._l(t.$store.state.user.projectList,function(t){return r("Option",{key:t.bid,attrs:{label:t.projectName,value:t.bid}})}))],1),r("FormItem",{attrs:{label:"日期区间"}},[r("DatePicker",{staticClass:"my-input",attrs:{type:"daterange","split-panels":"",placeholder:"",clearable:!1,editable:!1,options:t.pickerOptions},model:{value:t.paramDto.date,callback:function(e){t.$set(t.paramDto,"date",e)},expression:"paramDto.date"}})],1),r("FormItem",[r("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.getData}},[t._v(" 查 询")])],1)],1)],1),r("Col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[r("Button",{attrs:{type:"warning",icon:"ios-cloud-download-outline"},on:{click:t.exportFile}},[t._v(" 导 出")])],1)],1),r("Table",{attrs:{columns:t.columns,data:t.listDate},scopedSlots:t._u([{key:"type",fn:function(e){var a=e.row;return[1===a.type?r("Tag",{attrs:{color:"blue"}},[t._v("运营期")]):r("Tag",{attrs:{color:"green"}},[t._v("销售期")])]}}])}),r("export-file",{ref:"exportFile"})],1)},i=[],n=r("90de"),o=r("6b6c"),c=function(t){return o["a"].request({url:"/reportDaily/reportDailyIndex.action",method:"get",params:t})},s=r("ef05"),l={name:"dailyIndex",components:{ExportFile:s["a"]},data:function(){return{paramDto:{projectBid:this.$store.state.user.projectList[0].bid,date:[],startCreateTime:"",endCreateTime:""},loading:!1,listDate:[],columns:[{title:"日期",key:"recordDate"},{title:"床位数",key:"bedTotalCount"},{title:"入住床位数",key:"checkinCount"},{title:"OCC（入住率）",key:"occ",render:function(t,e){return t("div","".concat(e.row.occ,"%"))}},{title:"ADR（已售客房平均房价）",key:"ard"},{title:"RevPAR（每间可售房收入）",key:"revpar"}],pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}},visible:!1,percent:0,interval:""}},methods:{getData:function(){var t=this;this.loading=!0;var e={projectBid:this.paramDto.projectBid,startCreateTime:Object(n["d"])(this.paramDto.date[0],"date"),endCreateTime:Object(n["d"])(this.paramDto.date[1],"date")};c(e).then(function(e){t.listDate=e.body.rows,t.loading=!1}).catch(function(){t.loading=!1})},exportFile:function(){this.percent=0;var t={type:1e3,jsonParam:JSON.stringify({projectBid:this.paramDto.projectBid,startCreateTime:Object(n["d"])(this.paramDto.date[0],"date"),endCreateTime:Object(n["d"])(this.paramDto.date[1],"date")})};this.$refs.exportFile.requestExportFile(t)}},created:function(){var t=new Date(Date.now()-864e5);this.paramDto.date.push(t),this.paramDto.date.push(t),this.getData()}},u=l,d=(r("e580"),r("2877")),p=Object(d["a"])(u,a,i,!1,null,"2e3e4fd9",null);p.options.__file="dailyIndex.vue";e["default"]=p.exports},9709:function(t,e,r){},b0e1:function(t,e,r){"use strict";var a=r("9709"),i=r.n(a);i.a},b404:function(t,e,r){},e580:function(t,e,r){"use strict";var a=r("b404"),i=r.n(a);i.a},ef05:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Modal",{attrs:{title:t.title,closable:!1,"mask-closable":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("Progress",{attrs:{percent:t.percent}}),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"text"},on:{click:t.cancelExport}},[t._v("取消")])],1)],1)},i=[],n=r("2934"),o={name:"ExportFile",props:{},data:function(){return{title:"",visible:!1,percent:0,interval:""}},methods:{requestExportFile:function(t){var e=this;this.title="导出文件准备中...",this.percent=0,this.visible=!0,Object(n["d"])(t).then(function(t){e.title="正在导出文件...",e.interval=setInterval(function(){return e.getExportProcess(t.body)},300)}).catch(function(){e.visible=!1})},getExportProcess:function(t){var e=this;Object(n["c"])(t).then(function(t){t.body.finish?(e.percent=100,setTimeout(function(){e.visible=!1},800),e.$Message.success("文件已生成，开始下载"),clearInterval(e.interval),e.download(t.body.fileUrl)):e.percent=t.body.percent}).catch(function(){e.visible=!1,clearInterval(e.interval)})},download:function(t){var e=document.createElement("a");e.href=t,e.style="visibility: hidden",e.download="".concat(Date.now(),".xls"),document.body.appendChild(e),e.click(),this.$forceUpdate(),setTimeout(function(){document.body.removeChild(e)},1e3)},cancelExport:function(){this.visible=!1,clearInterval(this.interval)}}},c=o,s=(r("b0e1"),r("2877")),l=Object(s["a"])(c,a,i,!1,null,"e5be986e",null);l.options.__file="ExportFile.vue";e["a"]=l.exports}}]);