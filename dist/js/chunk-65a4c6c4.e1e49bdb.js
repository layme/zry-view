(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65a4c6c4"],{"16e0":function(t,e,a){},"386d":function(t,e,a){"use strict";var n=a("cb7c"),r=a("83a1"),o=a("5f1b");a("214f")("search",1,function(t,e,a,i){return[function(a){var n=t(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,n):new RegExp(a)[e](String(n))},function(t){var e=i(a,t,this);if(e.done)return e.value;var l=n(t),s=String(this),u=l.lastIndex;r(u,0)||(l.lastIndex=0);var c=o(l,s);return r(l.lastIndex,u)||(l.lastIndex=u),null===c?-1:c.index}]})},"4dbb":function(t,e,a){"use strict";var n=a("94b9"),r=a.n(n);r.a},"56df":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("evaluate-form",{on:{search:t.listEvaluate}}),a("div",{staticClass:"full-top"},[t.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):t._e(),t._l(t.evaluateList,function(e,n){return a("evaluate-card",{key:n,staticClass:"my-card",attrs:{row:e,index:n},on:{link:t.toOrderDetail,reply:t.openReplyModal,shield:t.confirmShieldEvaluate}})}),t.evaluateList.length?t._e():a("Card",{staticClass:"my-card"},[a("div",{staticClass:"no-data"},[a("span",[t._v("没有找到匹配的记录")])])])],2),a("Page",{staticClass:"my-page",attrs:{total:t.total,"show-total":"",current:t.paramDto.pageIndex,"page-size":t.paramDto.pageSize},on:{"update:current":function(e){t.$set(t.paramDto,"pageIndex",e)},"on-change":t.handlePageChange}}),a("Modal",{attrs:{title:t.replyTitle,loading:t.replyLoading},on:{"on-ok":t.replyValid},model:{value:t.replyVisible,callback:function(e){t.replyVisible=e},expression:"replyVisible"}},[t.replyVisible?a("Form",{ref:"replyForm",attrs:{model:t.replyDto,rules:t.replyRules,"label-width":0}},[a("FormItem",{attrs:{prop:"feedbackRemark"}},[a("Input",{attrs:{type:"textarea",rows:5,maxlength:200,placeholder:"此处最多输入200个字符"},model:{value:t.replyDto.feedbackRemark,callback:function(e){t.$set(t.replyDto,"feedbackRemark",e)},expression:"replyDto.feedbackRemark"}})],1)],1):t._e(),t.replyDto.lowEvaluateManagerFeedbackTime?a("div",{staticStyle:{"margin-top":"20px"}},[a("span",[t._v("回复时间："+t._s(t._f("dateTimeFilter")(t.replyDto.lowEvaluateManagerFeedbackTime)))]),t._v("    \n      "),a("span",[t._v("回复员工："+t._s(t.replyDto.feedbackerName))])]):t._e()],1)],1)},r=[],o=(a("f751"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{attrs:{model:t.paramDto,"label-width":80}},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"订单编号"}},[a("Input",{attrs:{placeholder:"",clearable:""},model:{value:t.paramDto.orderNumber,callback:function(e){t.$set(t.paramDto,"orderNumber","string"===typeof e?e.trim():e)},expression:"paramDto.orderNumber"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"评价日期"}},[a("DatePicker",{staticClass:"full-width",attrs:{type:"daterange","split-panels":"",placeholder:"",clearable:""},model:{value:t.paramDto.evaluateTime,callback:function(e){t.$set(t.paramDto,"evaluateTime",e)},expression:"paramDto.evaluateTime"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"总分区间"}},[a("Select",{attrs:{placeholder:"",clearable:""},model:{value:t.paramDto.totalScore,callback:function(e){t.$set(t.paramDto,"totalScore",e)},expression:"paramDto.totalScore"}},t._l(t.totalScoreOptions,function(t){return a("Option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1),a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"回复状态"}},[a("RadioGroup",{model:{value:t.paramDto.lowEvaluateManagerFeedbackStatus,callback:function(e){t.$set(t.paramDto,"lowEvaluateManagerFeedbackStatus",e)},expression:"paramDto.lowEvaluateManagerFeedbackStatus"}},[a("Radio",{attrs:{label:"",border:""}},[t._v("全部")]),a("Radio",{attrs:{label:1,border:""}},[t._v("已回复")]),a("Radio",{attrs:{label:0,border:""}},[t._v("未回复")])],1)],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"屏蔽状态"}},[a("RadioGroup",{model:{value:t.paramDto.evaluateStatus,callback:function(e){t.$set(t.paramDto,"evaluateStatus",e)},expression:"paramDto.evaluateStatus"}},[a("Radio",{attrs:{label:"",border:""}},[t._v("全部")]),a("Radio",{attrs:{label:0,border:""}},[t._v("已屏蔽")])],1)],1)],1)],1),a("Row",[a("Col",{attrs:{span:12}},[a("Button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查 询")])],1),a("Col",{style:{textAlign:"right"},attrs:{span:12}},[a("count-to",{attrs:{end:t.totalScore,"count-class":t.countText,decimals:1}},[a("span",{staticClass:"slot-text",attrs:{slot:"left"},slot:"left"},[t._v("项目总体评星: ")])])],1)],1)],1)}),i=[],l=(a("386d"),a("c5f6"),a("90de")),s=a("9349"),u={name:"evaluateForm",props:{totalScore:{type:Number,default:5}},components:{countTo:s["a"]},data:function(){return{paramDto:{orderNumber:"",evaluateTime:[],startDate:"",endDate:"",lowEvaluateManagerFeedbackStatus:"",evaluateStatus:"",pageFlag:!0},totalScoreOptions:[{value:5,label:"4.5~5.0 (不含4.5)"},{value:4,label:"4.0~4.5 (不含4.0)"},{value:3,label:"3.5~4.0 (不含3.5)"},{value:2,label:"3.5及其以下"}],countText:{fontSize:"22px",color:"#2d8cf0",fontWeight:"bold"}}},methods:{search:function(){this.$emit("search",this.paramDto)}},watch:{"paramDto.evaluateTime":function(t){this.paramDto.startDate=t[0]?Object(l["f"])(t[0],"date"):"",this.paramDto.endDate=t[1]?Object(l["f"])(t[1],"date"):""},"$store.state.user.currentProject":function(t){this.paramDto.projectBid=t.bid,this.search()}},created:function(){this.search()}},c=u,d=(a("4dbb"),a("2877")),p=Object(d["a"])(c,o,i,!1,null,"2e4ab6f8",null);p.options.__file="evaluateForm.vue";var m=p.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",[0===t.row.evaluateStatus?a("div",{staticClass:"discard"},[a("div",{staticClass:"discard-logo"},[t._v("已屏蔽")])]):t._e(),a("Row",[a("Col",{attrs:{span:10}},[a("a",{on:{click:t.link}},[t._v(t._s(t.row.businessCode))]),t.row.lowEvaluateManagerFeedbackStatus?a("Tag",{staticStyle:{"margin-left":"30px"},attrs:{color:"volcano"}},[t._v("已回复")]):a("Tag",{staticStyle:{"margin-left":"30px"},attrs:{color:"volcano"}},[t._v("未回复")])],1),a("Col",{style:{textAlign:"right"},attrs:{span:14}},[a("a",{staticClass:"my-btn",on:{click:t.reply}},[t._v("回复")]),a("a",{on:{click:t.shield}},[t._v(t._s(1===t.row.evaluateStatus?"屏蔽":"展示"))])])],1),a("Row",{staticClass:"evaluate-list"},[a("Col",{attrs:{span:3}},[a("span",[t._v("总体评星")]),a("span",{staticClass:"my-score"},[t._v(t._s(t.row.customerAvgStarLevel))])]),t._l(t.row.starList,function(e,n){return a("Col",{key:n,attrs:{span:3}},[a("span",[t._v(t._s(e.questionContent))]),a("span",{staticClass:"my-score"},[t._v(t._s(e.answerContent))])])})],2),a("Row",{staticClass:"evaluate-list my-content"},[t._v("\n    "+t._s(t.row.customerSuggestion?t.row.customerSuggestion:"用户没有给出评价文字")+"\n  ")]),a("Row",{staticClass:"evaluate-list"},t._l(t.row.labelList,function(e,n){return a("Tag",{key:n,staticStyle:{"margin-right":"10px"},attrs:{color:"blue"}},[t._v("\n      "+t._s(e.answerContent)+"\n    ")])})),a("Row",{staticClass:"evaluate-list",attrs:{gutter:20}},t._l(t.row.urlList,function(e,n){return a("Col",{key:n,attrs:{span:3}},[a("Tooltip",{attrs:{effect:"dark",content:"点击查看大图",placement:"bottom"}},[a("div",{staticClass:"grid-content cover"},[a("img",{staticClass:"img-class",attrs:{src:e.answerContent,preview:t.index,alt:"评价附图"}})])])],1)})),a("Row",{staticClass:"evaluate-list"},[a("span",{staticStyle:{color:"#909399"}},[t._v("发表于  "+t._s(t._f("dateTimeFilter")(t.row.evaluateTime)))])])],1)},v=[],h={name:"evaluateCard",props:{row:Object,index:Number},methods:{link:function(){this.$emit("link",this.row.businessCode)},reply:function(){this.$emit("reply",this.row)},shield:function(){this.$emit("shield",this.row)}},filters:{statusFilter:function(t){return 1===t?"已回复":"未回复"}}},g=h,b=(a("a5be"),Object(d["a"])(g,f,v,!1,null,"3fd64f0a",null));b.options.__file="evaluateCard.vue";var w=b.exports,y=a("dffe"),V={name:"evaluateList",components:{evaluateForm:m,evaluateCard:w},data:function(){return{totalScore:"",paramDto:{pageIndex:1,pageSize:5},loading:!1,delay:1e3,replyVisible:!1,replyLoading:!0,replyTitle:"",total:0,evaluateList:[],replyDto:{lowEvaluateRecordCode:0,feedbackRemark:""},replyRules:{feedbackRemark:[{required:!0,message:"请输入回复内容",trigger:"blur"}]}}},methods:{listEvaluate:function(t){Object.assign(this.paramDto,t),this.paramDto.pageIndex=1,this.handlePageChange(),this.projectScore(this.paramDto.projectBid)},handlePageChange:function(){var t=this;this.loading=!0,this.$delete(this.paramDto,"evaluateTime"),Object(y["a"])(this.paramDto).then(function(e){t.evaluateList=e.body.rows,t.total=e.body.total,t.loading=!1}).catch(function(){t.loading=!1})},projectScore:function(){var t=this;Object(y["d"])(this.$store.state.user.currentProject.bid).then(function(e){t.totalScore=e.data})},toOrderDetail:function(t){var e={name:"orderDetail",query:{orderNumber:t}};this.$router.push(e)},openReplyModal:function(t){0===t.lowEvaluateManagerFeedbackStatus?this.replyTitle="回复评价":this.replyTitle="编辑回复",this.replyDto.lowEvaluateRecordCode=t.logicCode,this.replyDto.feedbackRemark=t.lowEvaluateManagerFeedbackRemark,this.replyDto.lowEvaluateManagerFeedbackTime=t.lowEvaluateManagerFeedbackTime,this.replyDto.feedbackerName=t.lowEvaluateManagerName,this.replyVisible=!0},replyValid:function(){var t=this;this.$refs.replyForm.validate(function(e){e?t.reply():t.handleError()})},handleError:function(){var t=this;setTimeout(function(){t.replyLoading=!1,t.$nextTick(function(){t.replyLoading=!0})},500)},reply:function(){var t=this;Object(y["e"])(this.replyDto).then(function(e){t.$Message.success("回复成功，数据稍后刷新"),setTimeout(function(){t.handlePageChange()},t.delay),t.replyVisible=!1}).catch(function(){t.handleError()})},confirmShieldEvaluate:function(t){var e=this,a="",n="",r=0;1===t.evaluateStatus?(a="屏蔽后，用户将无法在APP中查看到该评价，",n="屏蔽",r=0):(a="展示后，用户可以在APP中查看到该评价，",n="展示",r=1),this.$Modal.confirm({title:"通知",content:"<p>".concat(a,"</p><p>继续吗？</p>"),onOk:function(){e.shieldValuate(t,r,n)},onCancel:function(){}})},shieldValuate:function(t,e,a){var n=this,r={recordId:t.logicCode,isValid:e};Object(y["g"])(r).then(function(t){n.$Message.success("".concat(a,"成功")),setTimeout(function(){n.handlePageChange()},n.delay)})}},watch:{"replyDto.feedbackRemark":{handler:function(t){}}}},_=V,C=(a("8b6a"),Object(d["a"])(_,n,r,!1,null,"3ccdeba8",null));C.options.__file="evaluateList.vue";e["default"]=C.exports},"57f2":function(t,e,a){var n,r;!function(o,i){n=i,r="function"===typeof n?n.call(e,a,e,t):n,void 0===r||(t.exports=r)}(0,function(t,e,a){var n=function(t,e,a,n,r,o){for(var i=0,l=["webkit","moz","ms","o"],s=0;s<l.length&&!window.requestAnimationFrame;++s)window.requestAnimationFrame=window[l[s]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[l[s]+"CancelAnimationFrame"]||window[l[s]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var a=(new Date).getTime(),n=Math.max(0,16-(a-i)),r=window.setTimeout(function(){t(a+n)},n);return i=a+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)});var u=this;for(var c in u.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:null,formattingFn:null},o)o.hasOwnProperty(c)&&(u.options[c]=o[c]);""===u.options.separator&&(u.options.useGrouping=!1),u.options.prefix||(u.options.prefix=""),u.options.suffix||(u.options.suffix=""),u.d="string"==typeof t?document.getElementById(t):t,u.startVal=Number(e),u.endVal=Number(a),u.countDown=u.startVal>u.endVal,u.frameVal=u.startVal,u.decimals=Math.max(0,n||0),u.dec=Math.pow(10,u.decimals),u.duration=1e3*Number(r)||2e3,u.formatNumber=function(t){var e,a,n,r;if(t=t.toFixed(u.decimals),t+="",e=t.split("."),a=e[0],n=e.length>1?u.options.decimal+e[1]:"",r=/(\d+)(\d{3})/,u.options.useGrouping)for(;r.test(a);)a=a.replace(r,"$1"+u.options.separator+"$2");return u.options.prefix+a+n+u.options.suffix},u.easeOutExpo=function(t,e,a,n){return a*(1-Math.pow(2,-10*t/n))*1024/1023+e},u.easingFn=u.options.easingFn?u.options.easingFn:u.easeOutExpo,u.formattingFn=u.options.formattingFn?u.options.formattingFn:u.formatNumber,u.version=function(){return"1.7.1"},u.printValue=function(t){var e=u.formattingFn(t);"INPUT"===u.d.tagName?this.d.value=e:"text"===u.d.tagName||"tspan"===u.d.tagName?this.d.textContent=e:this.d.innerHTML=e},u.count=function(t){u.startTime||(u.startTime=t),u.timestamp=t;var e=t-u.startTime;u.remaining=u.duration-e,u.options.useEasing?u.countDown?u.frameVal=u.startVal-u.easingFn(e,0,u.startVal-u.endVal,u.duration):u.frameVal=u.easingFn(e,u.startVal,u.endVal-u.startVal,u.duration):u.countDown?u.frameVal=u.startVal-(u.startVal-u.endVal)*(e/u.duration):u.frameVal=u.startVal+(u.endVal-u.startVal)*(e/u.duration),u.countDown?u.frameVal=u.frameVal<u.endVal?u.endVal:u.frameVal:u.frameVal=u.frameVal>u.endVal?u.endVal:u.frameVal,u.frameVal=Math.round(u.frameVal*u.dec)/u.dec,u.printValue(u.frameVal),e<u.duration?u.rAF=requestAnimationFrame(u.count):u.callback&&u.callback()},u.start=function(t){return u.callback=t,u.rAF=requestAnimationFrame(u.count),!1},u.pauseResume=function(){u.paused?(u.paused=!1,delete u.startTime,u.duration=u.remaining,u.startVal=u.frameVal,requestAnimationFrame(u.count)):(u.paused=!0,cancelAnimationFrame(u.rAF))},u.reset=function(){u.paused=!1,delete u.startTime,u.startVal=e,cancelAnimationFrame(u.rAF),u.printValue(u.startVal)},u.update=function(t){cancelAnimationFrame(u.rAF),u.paused=!1,delete u.startTime,u.startVal=u.frameVal,u.endVal=Number(t),u.countDown=u.startVal>u.endVal,u.rAF=requestAnimationFrame(u.count)},u.printValue(u.startVal)};return n})},"5a5a":function(t,e,a){},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"8b6a":function(t,e,a){"use strict";var n=a("fc20"),r=a.n(n);r.a},9349:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"count-to-wrapper"},[t._t("left"),a("p",{staticClass:"content-outer"},[a("span",{class:["count-to-count-text"],style:t.countClass,attrs:{id:t.counterId}},[t._v(t._s(t.init))]),a("i",{class:["count-to-unit-text"],style:t.unitClass},[t._v(t._s(t.unitText))])]),t._t("right")],2)},r=[],o=(a("c5f6"),a("57f2")),i=a.n(o),l=(a("16e0"),{name:"CountTo",props:{init:{type:Number,default:0},startVal:{type:Number,default:0},end:{type:Number,required:!0},decimals:{type:Number,default:0},decimal:{type:String,default:"."},duration:{type:Number,default:2},delay:{type:Number,default:0},uneasing:{type:Boolean,default:!1},usegroup:{type:Boolean,default:!1},separator:{type:String,default:","},simplify:{type:Boolean,default:!1},unit:{type:Array,default:function(){return[[3,"K+"],[6,"M+"],[9,"B+"]]}},countClass:{type:Object},unitClass:{type:Object}},data:function(){return{counter:null,unitText:""}},computed:{counterId:function(){return"count_to_".concat(this._uid)}},methods:{getHandleVal:function(t,e){return{endVal:parseInt(t/Math.pow(10,this.unit[e-1][0])),unitText:this.unit[e-1][1]}},transformValue:function(t){var e=this.unit.length,a={endVal:0,unitText:""};if(t<Math.pow(10,this.unit[0][0]))a.endVal=t;else for(var n=1;n<e;n++)t>=Math.pow(10,this.unit[n-1][0])&&t<Math.pow(10,this.unit[n][0])&&(a=this.getHandleVal(t,n));return t>Math.pow(10,this.unit[e-1][0])&&(a=this.getHandleVal(t,e)),a},getValue:function(t){var e=0;if(this.simplify){var a=this.transformValue(t),n=a.endVal,r=a.unitText;this.unitText=r,e=n}else e=t;return e}},mounted:function(){var t=this;this.$nextTick(function(){var e=t.getValue(t.end);t.counter=new i.a(t.counterId,t.startVal,e,t.decimals,t.duration,{useEasing:!t.uneasing,useGrouping:t.useGroup,separator:t.separator,decimal:t.decimal}),setTimeout(function(){t.counter.error||t.counter.start()},t.delay)})},watch:{end:function(t){var e=this.getValue(t);this.counter.update(e)}}}),s=l,u=a("2877"),c=Object(u["a"])(s,n,r,!1,null,null,null);c.options.__file="count-to.vue";var d=c.exports;e["a"]=d},"94b9":function(t,e,a){},a5be:function(t,e,a){"use strict";var n=a("5a5a"),r=a.n(n);r.a},dffe:function(t,e,a){"use strict";a.d(e,"a",function(){return r}),a.d(e,"d",function(){return o}),a.d(e,"g",function(){return i}),a.d(e,"e",function(){return l}),a.d(e,"c",function(){return s}),a.d(e,"b",function(){return u}),a.d(e,"f",function(){return c});var n=a("6b6c"),r=function(t){return n["a"].request({url:"/evaluate/batch.action",method:"get",params:t})},o=function(t){return n["a"].request({url:"/evaluate/v1.action",method:"get",params:{projectBid:t}})},i=function(t){return n["a"].request({url:"/evaluate/".concat(t.recordId,".action"),method:"post",data:t})},l=function(t){return n["a"].request({url:"/evaluate/".concat(t.lowEvaluateRecordCode,".action"),method:"put",data:t})},s=function(t){return n["a"].request({url:"/lowEvaluate/batch.action",method:"get",params:t})},u=function(t){return n["a"].request({url:"/lowEvaluate/".concat(t.lowEvaluateBid,".action"),method:"get",params:t})},c=function(t){return n["a"].request({url:"/lowEvaluate/".concat(t.lowEvaluateBid,".action"),method:"put",data:t})}},fc20:function(t,e,a){}}]);