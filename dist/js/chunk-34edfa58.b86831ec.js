(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34edfa58"],{"010b":function(t,e,a){},"16e0":function(t,e,a){},"1f39":function(t,e,a){},"21e7":function(t,e,a){"use strict";var r=a("1f39"),n=a.n(r);n.a},2388:function(t,e,a){"use strict";var r=a("9a0e"),n=a.n(r);n.a},2607:function(t,e,a){},"3a8f":function(t,e,a){},"46cc":function(t,e,a){},"49fe":function(t,e,a){"use strict";var r=a("df77"),n=a.n(r);n.a},"57f2":function(t,e,a){var r,n;!function(o,s){r=s,n="function"===typeof r?r.call(e,a,e,t):r,void 0===n||(t.exports=n)}(0,function(t,e,a){var r=function(t,e,a,r,n,o){for(var s=0,i=["webkit","moz","ms","o"],l=0;l<i.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[i[l]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[l]+"CancelAnimationFrame"]||window[i[l]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var a=(new Date).getTime(),r=Math.max(0,16-(a-s)),n=window.setTimeout(function(){t(a+r)},r);return s=a+r,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)});var c=this;for(var d in c.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:null,formattingFn:null},o)o.hasOwnProperty(d)&&(c.options[d]=o[d]);""===c.options.separator&&(c.options.useGrouping=!1),c.options.prefix||(c.options.prefix=""),c.options.suffix||(c.options.suffix=""),c.d="string"==typeof t?document.getElementById(t):t,c.startVal=Number(e),c.endVal=Number(a),c.countDown=c.startVal>c.endVal,c.frameVal=c.startVal,c.decimals=Math.max(0,r||0),c.dec=Math.pow(10,c.decimals),c.duration=1e3*Number(n)||2e3,c.formatNumber=function(t){var e,a,r,n;if(t=t.toFixed(c.decimals),t+="",e=t.split("."),a=e[0],r=e.length>1?c.options.decimal+e[1]:"",n=/(\d+)(\d{3})/,c.options.useGrouping)for(;n.test(a);)a=a.replace(n,"$1"+c.options.separator+"$2");return c.options.prefix+a+r+c.options.suffix},c.easeOutExpo=function(t,e,a,r){return a*(1-Math.pow(2,-10*t/r))*1024/1023+e},c.easingFn=c.options.easingFn?c.options.easingFn:c.easeOutExpo,c.formattingFn=c.options.formattingFn?c.options.formattingFn:c.formatNumber,c.version=function(){return"1.7.1"},c.printValue=function(t){var e=c.formattingFn(t);"INPUT"===c.d.tagName?this.d.value=e:"text"===c.d.tagName||"tspan"===c.d.tagName?this.d.textContent=e:this.d.innerHTML=e},c.count=function(t){c.startTime||(c.startTime=t),c.timestamp=t;var e=t-c.startTime;c.remaining=c.duration-e,c.options.useEasing?c.countDown?c.frameVal=c.startVal-c.easingFn(e,0,c.startVal-c.endVal,c.duration):c.frameVal=c.easingFn(e,c.startVal,c.endVal-c.startVal,c.duration):c.countDown?c.frameVal=c.startVal-(c.startVal-c.endVal)*(e/c.duration):c.frameVal=c.startVal+(c.endVal-c.startVal)*(e/c.duration),c.countDown?c.frameVal=c.frameVal<c.endVal?c.endVal:c.frameVal:c.frameVal=c.frameVal>c.endVal?c.endVal:c.frameVal,c.frameVal=Math.round(c.frameVal*c.dec)/c.dec,c.printValue(c.frameVal),e<c.duration?c.rAF=requestAnimationFrame(c.count):c.callback&&c.callback()},c.start=function(t){return c.callback=t,c.rAF=requestAnimationFrame(c.count),!1},c.pauseResume=function(){c.paused?(c.paused=!1,delete c.startTime,c.duration=c.remaining,c.startVal=c.frameVal,requestAnimationFrame(c.count)):(c.paused=!0,cancelAnimationFrame(c.rAF))},c.reset=function(){c.paused=!1,delete c.startTime,c.startVal=e,cancelAnimationFrame(c.rAF),c.printValue(c.startVal)},c.update=function(t){cancelAnimationFrame(c.rAF),c.paused=!1,delete c.startTime,c.startVal=c.frameVal,c.endVal=Number(t),c.countDown=c.startVal>c.endVal,c.rAF=requestAnimationFrame(c.count)},c.printValue(c.startVal)};return r})},"5d53":function(t,e,a){"use strict";var r=a("2607"),n=a.n(r);n.a},"6b70":function(t,e,a){"use strict";var r=a("91bc"),n=a.n(r);n.a},"6de3":function(t,e,a){},"91bc":function(t,e,a){},9349:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"count-to-wrapper"},[t._t("left"),a("p",{staticClass:"content-outer"},[a("span",{class:["count-to-count-text"],style:t.countClass,attrs:{id:t.counterId}},[t._v(t._s(t.init))]),a("i",{class:["count-to-unit-text"],style:t.unitClass},[t._v(t._s(t.unitText))])]),t._t("right")],2)},n=[],o=(a("c5f6"),a("57f2")),s=a.n(o),i=(a("16e0"),{name:"CountTo",props:{init:{type:Number,default:0},startVal:{type:Number,default:0},end:{type:Number,required:!0},decimals:{type:Number,default:0},decimal:{type:String,default:"."},duration:{type:Number,default:2},delay:{type:Number,default:0},uneasing:{type:Boolean,default:!1},usegroup:{type:Boolean,default:!1},separator:{type:String,default:","},simplify:{type:Boolean,default:!1},unit:{type:Array,default:function(){return[[3,"K+"],[6,"M+"],[9,"B+"]]}},countClass:{type:Object},unitClass:{type:Object}},data:function(){return{counter:null,unitText:""}},computed:{counterId:function(){return"count_to_".concat(this._uid)}},methods:{getHandleVal:function(t,e){return{endVal:parseInt(t/Math.pow(10,this.unit[e-1][0])),unitText:this.unit[e-1][1]}},transformValue:function(t){var e=this.unit.length,a={endVal:0,unitText:""};if(t<Math.pow(10,this.unit[0][0]))a.endVal=t;else for(var r=1;r<e;r++)t>=Math.pow(10,this.unit[r-1][0])&&t<Math.pow(10,this.unit[r][0])&&(a=this.getHandleVal(t,r));return t>Math.pow(10,this.unit[e-1][0])&&(a=this.getHandleVal(t,e)),a},getValue:function(t){var e=0;if(this.simplify){var a=this.transformValue(t),r=a.endVal,n=a.unitText;this.unitText=n,e=r}else e=t;return e}},mounted:function(){var t=this;this.$nextTick(function(){var e=t.getValue(t.end);t.counter=new s.a(t.counterId,t.startVal,e,t.decimals,t.duration,{useEasing:!t.uneasing,useGrouping:t.useGroup,separator:t.separator,decimal:t.decimal}),setTimeout(function(){t.counter.error||t.counter.start()},t.delay)})},watch:{end:function(t){var e=this.getValue(t);this.counter.update(e)}}}),l=i,c=a("2877"),d=Object(c["a"])(l,r,n,!1,null,null,null);d.options.__file="count-to.vue";var u=d.exports;e["a"]=u},"94ab":function(t,e,a){"use strict";var r=a("46cc"),n=a.n(r);n.a},"9a0e":function(t,e,a){},a189:function(t,e,a){"use strict";var r=a("3a8f"),n=a.n(r);n.a},b110:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative"}},[t._e(),a("Row",{attrs:{gutter:20}},[t._l(t.$store.state.workbench.passwords,function(e){return a("Col",{key:e.id,staticClass:"top-info",attrs:{span:4}},[a("info-card",{attrs:{disHover:"",color:"#2d8cf0",icon:"md-key","icon-size":30}},[a("count-to",{attrs:{end:parseInt(e.password),duration:.2,"count-class":t.countStyle}}),a("p",{staticStyle:{"font-size":"8px"}},[t._v(t._s(t._f("pswTypeFilter")(e.pswType)))])],1)],1)}),a("Col",{staticClass:"top-info",attrs:{span:4}},[a("info-card",{attrs:{disHover:"",color:"#ff9900",icon:"md-bulb","icon-size":30}},[a("count-to",{attrs:{end:t.$store.state.workbench.cleanCount,duration:.2,"count-class":t.countStyle}}),a("p",{staticStyle:{"font-size":"8px"}},[t._v("待保洁数量")])],1)],1),a("Col",{staticClass:"top-info",attrs:{span:4}},[a("info-card",{attrs:{disHover:"",color:"#ed4014",icon:"ios-cart","icon-size":30}},[a("count-to",{attrs:{end:t.$store.state.workbench.stockOrderCount,duration:.2,"count-class":t.countStyle}}),a("p",{staticStyle:{"font-size":"8px"}},[t._v("ON 待核订单")])],1)],1),a("Col",{staticClass:"top-info",attrs:{span:4}},[a("info-card",{attrs:{disHover:"",color:"#E46CBB",icon:"ios-cart-outline","icon-size":30}},[a("count-to",{attrs:{end:t.$store.state.workbench.unStockOrderCount,duration:.2,"count-class":t.countStyle}}),a("p",{staticStyle:{"font-size":"8px"}},[t._v("OFF 待核订单")])],1)],1)],2),a("Row",{staticStyle:{"margin-bottom":"10px"}},[a("Col",{attrs:{span:"18"}},[a("Button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary",ghost:""},on:{click:function(e){t.orderVisible=!0}}},[t._v("新增订单")]),a("Button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary",ghost:""},on:{click:function(e){t.lockVisible=!0}}},[t._v("锁定床位")]),a("span",[t._v("当前房型：")]),a("Dropdown",{on:{"on-click":t.handleHouseType}},[a("a",[t._v("\n          "+t._s(t.$store.state.workbench.currentHouseType.houseTypeName)+"\n          "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:-1}},[t._v("全部房型")]),t._l(t.$store.state.workbench.houseTypeList,function(e,r){return a("DropdownItem",{key:r,attrs:{name:r}},[t._v("\n            "+t._s(e.houseTypeParentName)+" - "+t._s(e.houseTypeName)+"\n          ")])})],2)],1)],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"6"}},[t._v("\n      图例:\n      "),a("Tag",{attrs:{color:"#facb65"}},[t._v("已支付")]),a("Tag",{attrs:{color:"#7ddca3"}},[t._v("已入住")]),a("Tag",{attrs:{color:"#00b4f7"}},[t._v("已退房")]),a("Tag",{attrs:{color:"#e8eaec"}},[t._v("锁定")])],1)],1),a("div",{staticClass:"full-top"},[t.$store.state.workbench.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):t._e(),a("bed-calendar",{attrs:{"today-str":t.todayStr},on:{dateChange:t.handleDateChange,refresh:t.handleRefresh}})],1),a("Modal",{attrs:{title:"新增订单",loading:t.orderLoading,width:"1200"},on:{"on-ok":t.validOrder},model:{value:t.orderVisible,callback:function(e){t.orderVisible=e},expression:"orderVisible"}},[t.orderVisible?a("create-order",{ref:"createOrderRef",on:{submit:t.handleSaveOrder,error:t.handleOrderError}}):t._e()],1),a("Modal",{attrs:{title:"锁定床位",loading:t.lockLoading,width:"900"},on:{"on-ok":t.validLock},model:{value:t.lockVisible,callback:function(e){t.lockVisible=e},expression:"lockVisible"}},[t.lockVisible?a("lock-bed",{ref:"lockRef",on:{submit:t.handleLockBed,error:t.handleLockError}}):t._e()],1)],1)},n=[],o=a("be94"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"info-card-wrapper",attrs:{shadow:t.shadow,"dis-hover":t.disHover,padding:0}},[a("div",{staticClass:"content-con"},[a("div",{staticClass:"left-area",style:{background:t.color,width:t.leftWidth}},[a("common-icon",{staticClass:"icon",attrs:{type:t.icon,size:t.iconSize,color:"#fff"}})],1),a("div",{staticClass:"right-area",style:{width:t.rightWidth}},[a("div",[t._t("default")],2)])])])},i=[],l=(a("c5f6"),a("cb21")),c={name:"InforCard",components:{CommonIcon:l["a"]},props:{left:{type:Number,default:36},color:{type:String,default:"#2d8cf0"},icon:{type:String,default:""},iconSize:{type:Number,default:20},shadow:{type:Boolean,default:!1},disHover:{type:Boolean,default:!1}},computed:{leftWidth:function(){return"".concat(this.left,"%")},rightWidth:function(){return"".concat(100-this.left,"%")}}},d=c,u=(a("a189"),a("2877")),p=Object(u["a"])(d,s,i,!1,null,null,null);p.options.__file="infor-card.vue";var m=p.exports,h=m,f=a("9349"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"calendar-top"},[t.$store.state.workbench.stockData.length?a("table",{attrs:{id:"t"}},[a("thead",[a("tr",[a("th",{attrs:{colspan:"2"}},[a("div",[a("div",{staticClass:"calendar-date"},[t._v("\n            起始日\n            "),a("DatePicker",{attrs:{open:t.open,value:t.startDateStr,format:"yyyy-MM-dd",type:"date",transfer:""},on:{"on-change":t.handleChange}},[a("a",{on:{click:t.handleClick}},[[t._v(t._s(t.startDateStr))]],2)])],1),a("div",[a("a",{on:{click:t.handleBack}},[a("Icon",{attrs:{type:"ios-arrow-back"}}),t._v("\n              上一周\n            ")],1),a("a",{staticStyle:{padding:"0 10px"},on:{click:t.handleToday}},[t._v("今天")]),a("a",{on:{click:t.handleForward}},[t._v("\n              下一周\n              "),a("Icon",{attrs:{type:"ios-arrow-forward"}})],1)])])]),t._l(t.$store.state.workbench.stockData,function(t){return a("th",{key:t.date},[a("date-cell",{attrs:{stock:t}})],1)})],2)]),t.$store.state.workbench.workData.length?a("tbody",[t._l(t.$store.state.workbench.workData,function(e){return t._l(e.beds,function(r,n){return a("tr",{key:r.bedBid},[0===n?a("td",{staticClass:"room-cell",attrs:{rowspan:e.beds.length}},[t._v(t._s(e.houseTypeName)),a("br"),t._v(t._s(e.areaShowName))]):t._e(),a("td",{staticClass:"bed-cell"},[a("bed-cell",{attrs:{bed:r},on:{refresh:t.getOrderDetail}})],1),t._l(r.calendarList,function(e,r){return a("td",{key:r+"-i",attrs:{colspan:e.length}},[a("order-cell",{attrs:{orders:e.orders},on:{refresh:t.getOrderDetail}})],1)})],2)})})],2):t._e()]):t._e()])},k=[],g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content",class:{active:t.stock.isActive||t.stock.isSelect&&t.$store.getters.mouseStatus}},[a("p",{staticClass:"date-content"},[t._v("\n    "+t._s(t.stock.date.substring(5)))]),a("P",{staticClass:"count-content"},[t.todayStr===t.stock.date?a("span",{staticClass:"today"},[t._v("今天")]):a("span",[t._v(t._s(t._f("weekFilter")(t.stock.date)))]),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.stock.availableStockCount))])])],1)},v=[],y=a("90de"),D={name:"dateCell",props:{stock:{type:Object}},data:function(){return{todayStr:Object(y["d"])(new Date,"date")}},filters:{weekFilter:function(t){return Object(y["b"])(t)}}},_=D,w=(a("49fe"),Object(u["a"])(_,g,v,!1,null,"ee450d6a",null));w.options.__file="dateCell.vue";var C=w.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"con"},[3===t.bed.bedStatus?a("div",{staticClass:"subscript",staticStyle:{"background-color":"#ff9900"}},[a("Icon",{attrs:{type:"md-bulb"}})],1):t._e(),a("span",{staticStyle:{"line-height":"60px"}},[t._v(t._s(t.bed.bedCode))]),a("div",{staticClass:"bed-status-set",on:{click:t.handleBedStatus}},[t._v(t._s(3===t.bed.bedStatus?"设为净房":"设为脏房"))])])},B=[],O=a("d43b"),T={name:"bedCell",props:{bed:Object},data:function(){return{}},computed:{bedStatusBC:function(){switch(this.bed.bedStatus){case 1:return"#5cadff";case 2:return"#19be6b";case 3:return"#ff9900";default:return"#2d8cf0"}}},methods:{handleBedStatus:function(){var t=this,e={bedBid:this.bed.bedBid,status:3===this.bed.bedStatus?1:3};Object(O["h"])(e).then(function(e){t.$Message.success("设置成功"),t.$emit("refresh")})}}},x=T,V=(a("5d53"),Object(u["a"])(x,S,B,!1,null,"9fd60648",null));V.options.__file="bedCell.vue";var $=V.exports,F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.orders.length?a("div",{staticClass:"order",style:{backgroundColor:t.orderBC}},[t.orders.length>1?a("div",{staticClass:"my-btn"},[a("Button",{attrs:{shape:"circle",icon:"ios-more",size:"small"},on:{click:function(e){e.preventDefault(),t.visible=!0}}})],1):t._e(),a("div",{staticStyle:{height:"100%"},on:{click:function(e){t.showOrder(0)}}},[a("div",{staticClass:"content"},[t._v(t._s(t.orderChannel))]),a("div",{staticClass:"content"},[t._v(t._s(t.orders[0].name))])]),a("Modal",{attrs:{title:"选择订单",width:"400","footer-hide":""},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},t._l(t.orders,function(e,r){return a("Alert",{key:r,staticStyle:{cursor:"pointer"},nativeOn:{click:function(e){t.toOrderDetail(r)}}},[t._v("\n      "+t._s(e.name)+"\n      "),a("template",{slot:"desc"},[t._v(t._s(e.orderNumber))])],2)})),a("Modal",{attrs:{title:"锁定信息",width:"400","ok-text":"解锁"},on:{"on-ok":t.unLockBed},model:{value:t.lockVisible,callback:function(e){t.lockVisible=e},expression:"lockVisible"}},[a("Form",{attrs:{model:t.lockInfo,"label-width":60}},[a("Row",[a("Col",{attrs:{span:10}},[a("FormItem",{attrs:{label:"原因: "}},[t._v("\n            "+t._s(t._f("reasonFilter")(t.lockInfo.reason))+"\n          ")])],1)],1),a("Row",[a("Col",{attrs:{span:20}},[a("FormItem",{attrs:{label:"备注: "}},[t._v("\n            "+t._s(t._f("nullFilter")(t.lockInfo.remark))+"\n          ")])],1)],1)],1)],1)],1):t._e()},N=[],I={name:"orderCell",props:{orders:Array},data:function(){return{visible:!1,lockVisible:!1,lockInfo:{}}},computed:{orderBC:function(){switch(this.orders[0].orderStatus){case 1:return"#facb65";case 2:return"#7ddca3";case 6:return"#00b4f7";case-1:return"#e8eaec";default:return"#ffffff"}},orderChannel:function(){return this.$store.state.workbench.orderEnums[this.orders[0].channel]}},methods:{showOrder:function(t){var e=this.orders[t].orderNumber;if(e)this.toOrderDetail(e);else{var a=this.orders[t].orderBid;this.openLockInfo(a),this.lockInfo={},this.lockVisible=!0}},toOrderDetail:function(t){var e={name:"orderDetail",query:{orderNumber:t}};this.$router.push(e)},openLockInfo:function(t){var e=this;Object(O["b"])(t).then(function(t){e.lockInfo=t.body})},unLockBed:function(){var t=this;Object(O["g"])(this.lockInfo.lockbedBid).then(function(e){t.$Message.success("解锁成功"),t.$emit("refresh")})}},filters:{reasonFilter:function(t){switch(t){case 1:return"OTA库存";case 2:return"装修";case 3:return"维修";case 4:return"其他"}}}},A=I,j=(a("21e7"),Object(u["a"])(A,F,N,!1,null,"c735536e",null));j.options.__file="orderCell.vue";var L=j.exports,R={name:"bedCalendar",components:{dateCell:C,bedCell:$,orderCell:L},data:function(){return{bedCount:0,todayStr:Object(y["d"])(new Date,"date"),startDateStr:Object(y["d"])(new Date,"date"),open:!1,stockData:this.$store.state.workbench.stockData,roomData:this.$store.state.workbench.workData}},methods:{handleChange:function(t){this.startDateStr=t,this.startDateStr!==this.todayStr&&this.$emit("dateChange",this.startDateStr),this.open=!1},handleClick:function(){this.open=!this.open},handleBack:function(){this.startDateStr=Object(y["a"])(this.startDateStr,-7),this.$emit("dateChange",this.startDateStr)},handleToday:function(){this.startDateStr=this.todayStr,this.$emit("dateChange",this.startDateStr)},handleForward:function(){this.startDateStr=Object(y["a"])(this.startDateStr,7),this.$emit("dateChange",this.startDateStr)},getOrderDetail:function(){this.$emit("refresh")}},watch:{"$store.state.workbench.stockData":function(){},"$store.state.workbench.workData":function(){}}},E=R,q=(a("2388"),Object(u["a"])(E,b,k,!1,null,"03d9b58c",null));q.options.__file="bedCalendar.vue";var M=q.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"orderForm",attrs:{model:t.paramDto,rules:t.rules,"label-width":80}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"姓名",prop:"orderName"}},[a("Input",{attrs:{placeholder:"预定人姓名",clearable:""},model:{value:t.paramDto.orderName,callback:function(e){t.$set(t.paramDto,"orderName","string"===typeof e?e.trim():e)},expression:"paramDto.orderName"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"手机",prop:"phone"}},[a("Input",{attrs:{placeholder:"预定人手机号",clearable:""},model:{value:t.paramDto.phone,callback:function(e){t.$set(t.paramDto,"phone","string"===typeof e?e.trim():e)},expression:"paramDto.phone"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"邮箱",prop:"mail"}},[a("Input",{attrs:{placeholder:"预定人邮箱",clearable:""},model:{value:t.paramDto.mail,callback:function(e){t.$set(t.paramDto,"mail","string"===typeof e?e.trim():e)},expression:"paramDto.mail"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"渠道",prop:"channel"}},[a("Select",{attrs:{placeholder:"请选择订单来源",clearable:""},model:{value:t.paramDto.channel,callback:function(e){t.$set(t.paramDto,"channel",e)},expression:"paramDto.channel"}},t._l(t.$store.state.workbench.orderEnums,function(e,r){return r>2&&r<100?a("Option",{key:e,attrs:{label:e,value:r}}):t._e()}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"订单号",prop:"otaOrderNumber"}},[a("Input",{attrs:{placeholder:"OTA订单号",clearable:""},model:{value:t.paramDto.otaOrderNumber,callback:function(e){t.$set(t.paramDto,"otaOrderNumber","string"===typeof e?e.trim():e)},expression:"paramDto.otaOrderNumber"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"金额",prop:"amount"}},[a("Input",{attrs:{placeholder:"OTA下单金额",clearable:""},model:{value:t.paramDto.amount,callback:function(e){t.$set(t.paramDto,"amount","string"===typeof e?e.trim():e)},expression:"paramDto.amount"}},[a("template",{slot:"prepend"},[t._v("¥")])],2)],1)],1)],1),a("Row",[a("Col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:"入住时段",prop:"dateRange"}},[a("DatePicker",{staticClass:"my-date-picker",attrs:{type:"daterange","split-panels":"",placeholder:"",clearable:!1,editable:!1},on:{"on-change":t.handleDateChange},model:{value:t.paramDto.dateRange,callback:function(e){t.$set(t.paramDto,"dateRange",e)},expression:"paramDto.dateRange"}})],1)],1),a("Col",{attrs:{span:2}},[a("Button",{staticClass:"del-btn",attrs:{type:"text"},on:{click:t.openBedSelector}},[t._v("选择床位")])],1)],1),a("FormItem",{attrs:{label:"已选床位",prop:"stayPersonInfo"}},t._l(t.paramDto.stayPersonInfo,function(e,r){return a("Tag",{key:r,staticClass:"my-tag",attrs:{closable:"",type:"dot",color:"primary","disable-transitions":!0},on:{"on-close":function(e){t.handleClose(r)}}},[t._v("\n        "+t._s(e.houseTypeName)+"-"+t._s(e.areaName)+"-"+t._s(e.areaBedCode)+"\n      ")])}))],1),a("Modal",{attrs:{title:"选择床位",width:"1000"},on:{"on-ok":t.addStayBed},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?a("bed-selector",{ref:"bedSelectorRef",attrs:{"start-date":t.paramDto.startDate,"end-date":t.paramDto.endDate,selected:t.paramDto.stayPersonInfo},on:{submit:t.handleAddStayBed}}):t._e()],1)],1)},z=[],H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{attrs:{model:t.paramDto,"label-width":40}},[a("FormItem",{attrs:{label:"房型"}},[a("Select",{staticClass:"my-select",attrs:{placeholder:"请选择房型"},on:{"on-change":t.handleChange},model:{value:t.paramDto.houseTypeBid,callback:function(e){t.$set(t.paramDto,"houseTypeBid",e)},expression:"paramDto.houseTypeBid"}},t._l(t.$store.state.workbench.houseTypeList,function(t){return a("Option",{key:t.bid,attrs:{label:t.houseTypeParentName+"-"+t.houseTypeName,value:t.bid}})}))],1)],1),a("div",{staticClass:"full-top"},[t.loading?a("Spin",{staticClass:"full-spin",attrs:{size:"large",fix:""}}):t._e(),t.stockData.length?a("Form",{attrs:{"label-width":70}},[a("CheckboxGroup",{on:{"on-change":t.handleCheckbox},model:{value:t.selectedAreaBedBid,callback:function(e){t.selectedAreaBedBid=e},expression:"selectedAreaBedBid"}},t._l(t.stockData,function(e){return a("FormItem",{key:e.bid,attrs:{label:e.showName}},[a("Row",t._l(e.aresBedList,function(r){return a("Col",{key:r.bid,staticStyle:{"text-align":"center"},attrs:{span:24/e.aresBedList.length}},[a("Checkbox",{staticClass:"my-checkbox",attrs:{label:e.houseTypeBid+","+e.bid+","+r.bid,disabled:1!==r.status}},[t._v("\n                "+t._s(t._f("bedCodeFilter")(r.bedCode))+"\n              ")])],1)}))],1)}))],1):a("div",{staticClass:"no-data"},[t._v("暂无数据")])],1),a("Form",{attrs:{"label-width":80}},[a("FormItem",{attrs:{label:"已选床位："}},t._l(t.selectedBed,function(e,r){return a("Tag",{key:r,staticClass:"my-tag",attrs:{closable:"",type:"dot",color:"primary","disable-transitions":!0},on:{"on-close":function(e){t.handleClose(r)}}},[t._v("\n        "+t._s(e.houseTypeName)+"-"+t._s(e.areaName)+"-"+t._s(e.areaBedCode)+"\n      ")])}))],1)],1)},W=[],G=(a("28a5"),a("ac6a"),a("7514"),a("2909")),J={name:"bedSelector",props:{startDate:String,endDate:String,selected:Array},data:function(){return{paramDto:{checkInTime:this.startDate,checkOutTime:this.endDate,houseTypeBid:""},loading:!1,allStockData:[],stockData:[],selectedBed:[],selectedAreaBedBid:[]}},methods:{handleChange:function(){this.getStock()},getStock:function(){var t=this;this.loading=!0,Object(O["c"])(this.paramDto).then(function(e){var a;t.stockData=e.body,(a=t.allStockData).push.apply(a,Object(G["a"])(e.body)),t.loading=!1}).catch(function(){t.loading=!1})},findHouseTypeName:function(t){var e=this.$store.state.workbench.houseTypeList.find(function(e){return e.bid===t});return e.houseTypeParentName+"-"+e.houseTypeName},handleCheckbox:function(){var t=this;this.selectedBed=[],this.selectedAreaBedBid.forEach(function(e){var a=e.split(","),r=t.allStockData.find(function(t){return t.bid===a[1]});if(r){var n=r.aresBedList.find(function(t){return t.bid===a[2]});n&&t.selectedBed.push({houseTypeBid:a[0],houseTypeName:t.findHouseTypeName(a[0]),areaBid:r.bid,areaName:r.areaName,areaBedBid:n.bid,areaBedCode:n.bedCode.substring(n.bedCode.length-2)})}})},handleClose:function(t){var e=this.selectedBed[t];this.selectedAreaBedBid.splice(this.selectedAreaBedBid.indexOf(e.houseTypeBid+","+e.areaBid+","+e.areaBedBid),1),this.selectedBed.splice(t,1)},submit:function(){this.$emit("submit",this.selectedBed)}},created:function(){var t=this;this.selected.length&&(this.selectedBed=this.selected,this.selected.forEach(function(e){return t.selectedAreaBedBid.push(e.houseTypeBid+","+e.areaBid+","+e.areaBedBid)}))}},K=J,U=(a("6b70"),Object(u["a"])(K,H,W,!1,null,"1f7acf48",null));U.options.__file="bedSelector.vue";var Q=U.exports,X={name:"createOrder",components:{bedSelector:Q},data:function(){return{paramDto:{amount:"",projectBid:this.$store.state.user.currentProject.bid,cityCode:"",uuid:"",firstChannel:2,channel:"",otaOrderNumber:"",orderName:"",phone:"",mail:"",dateRange:[],startDate:"",endDate:"",stayPersonInfo:[]},rules:{orderName:[{required:!0,message:"请输入预定人姓名",trigger:"blur"},{max:10,message:"不能超过10个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入预定人手机号",trigger:"blur"}],mail:[{pattern:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,message:"邮箱格式有误",trigger:"blur"}],channel:[{required:!0,message:"请输入下单渠道",trigger:"change"}],otaOrderNumber:[{required:!0,message:"请输入OTA订单号",trigger:"blur"},{max:10,message:"不能超过20个字符",trigger:"blur"}],amount:[{required:!0,message:"请输入OTA下单金额",trigger:"blur"},{pattern:/^\d{1,4}(\.\d{0,2})?$/,message:"请输入1万以内的两位小数或整数",trigger:"blur"}],dateRange:[{required:!0,type:"array",fields:{0:{type:"date",required:!0,message:"请选择入住时段"},1:{type:"date",required:!0,message:"请选择入住时段"}},trigger:"change"}],stayPersonInfo:[{required:!0,type:"array",message:"请选择入住床位",trigger:"blur"}]},visible:!1}},methods:{validateForm:function(){var t=this;this.$refs.orderForm.validate(function(e){e?t.$emit("submit",t.paramDto):t.$emit("error")})},openBedSelector:function(){this.paramDto.startDate&&this.paramDto.endDate?this.visible=!0:this.$Message.warning("请先选择入住时段")},addStayBed:function(){this.$refs.bedSelectorRef.submit()},handleAddStayBed:function(t){this.paramDto.stayPersonInfo=t},handleClose:function(t){this.paramDto.stayPersonInfo.splice(t,1)},handleDateChange:function(){this.paramDto.stockList=[]}},watch:{"paramDto.dateRange":function(t){this.paramDto.startDate=t[0]?Object(y["d"])(t[0],"date"):"",this.paramDto.endDate=t[1]?Object(y["d"])(t[1],"date"):""}}},Y=X,Z=(a("94ab"),Object(u["a"])(Y,P,z,!1,null,"c4c67eee",null));Z.options.__file="createOrder.vue";var tt=Z.exports,et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"lockForm",attrs:{model:t.paramDto,rules:t.rules,"label-width":80}},[a("Row",[a("Col",{attrs:{span:10}},[a("FormItem",{attrs:{label:"原因",prop:"reason"}},[a("Select",{staticClass:"my-form-ui",attrs:{placeholder:"请选择原因"},model:{value:t.paramDto.reason,callback:function(e){t.$set(t.paramDto,"reason",e)},expression:"paramDto.reason"}},t._l(t.reasonOptions,function(t){return a("Option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1),a("Row",[a("Col",{attrs:{span:20}},[a("FormItem",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",placeholder:"锁定备注，200字",row:2,maxlength:200},model:{value:t.paramDto.remark,callback:function(e){t.$set(t.paramDto,"remark","string"===typeof e?e.trim():e)},expression:"paramDto.remark"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"20"}},[a("FormItem",{attrs:{label:"锁定时段",prop:"dateRange"}},[a("DatePicker",{staticClass:"my-form-ui",attrs:{type:"daterange","split-panels":"",placeholder:"",options:t.datePickerOptions,clearable:!1,editable:!1},on:{"on-change":t.handleDateChange},model:{value:t.paramDto.dateRange,callback:function(e){t.$set(t.paramDto,"dateRange",e)},expression:"paramDto.dateRange"}})],1)],1),a("Col",{attrs:{span:4}},[a("Button",{staticClass:"del-btn",attrs:{type:"text"},on:{click:t.openBedSelector}},[t._v("选择床位")])],1)],1),a("FormItem",{attrs:{label:"已选床位",prop:"stockList"}},t._l(t.paramDto.stockList,function(e,r){return a("Tag",{key:r,staticClass:"my-tag",attrs:{closable:"",type:"dot",color:"primary","disable-transitions":!0},on:{"on-close":function(e){t.handleClose(r)}}},[t._v("\n        "+t._s(e.houseTypeName)+"-"+t._s(e.areaName)+"-"+t._s(e.areaBedCode)+"\n      ")])}))],1),a("Modal",{attrs:{title:"选择床位",width:"1000"},on:{"on-ok":t.addStayBed},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?a("bed-selector",{ref:"bedSelectorRef",attrs:{"start-date":t.paramDto.startDate,"end-date":t.paramDto.endDate,selected:t.paramDto.stockList},on:{submit:t.handleAddStayBed}}):t._e()],1)],1)},at=[],rt={name:"lockBed",components:{bedSelector:Q},data:function(){return{paramDto:{dateRange:[],startDate:"",endDate:"",reason:1,remark:"",stockList:[]},rules:{dateRange:[{required:!0,type:"array",fields:{0:{type:"date",required:!0,message:"请选择锁定时段"},1:{type:"date",required:!0,message:"请选择锁定时段"}},trigger:"change"}],stockList:[{required:!0,type:"array",message:"请选择锁定床位",trigger:"blur"}]},reasonOptions:[{label:"OTA库存",value:1},{label:"装修",value:2},{label:"维修",value:3},{label:"其他",value:4}],datePickerOptions:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}},visible:!1}},methods:{openBedSelector:function(){this.paramDto.startDate&&this.paramDto.endDate?this.visible=!0:this.$Message.warning("请先选择入住时段")},handleClose:function(t){this.paramDto.stockList.splice(t,1)},addStayBed:function(){this.$refs.bedSelectorRef.submit()},handleAddStayBed:function(t){this.paramDto.stockList=t},validateForm:function(){var t=this;this.$refs.lockForm.validate(function(e){e?t.$emit("submit",t.paramDto):t.$emit("error")})},handleDateChange:function(){this.paramDto.stockList=[]}},watch:{"paramDto.dateRange":function(t){this.paramDto.startDate=t[0]?Object(y["d"])(t[0],"date"):"",this.paramDto.endDate=t[1]?Object(y["d"])(t[1],"date"):""}}},nt=rt,ot=(a("f8b5"),Object(u["a"])(nt,et,at,!1,null,"4459bd48",null));ot.options.__file="lockBed.vue";var st=ot.exports,it=a("2f62"),lt=a("f8b7"),ct={name:"workbench",components:{InfoCard:h,CountTo:f["a"],bedCalendar:M,createOrder:tt,lockBed:st},data:function(){return{countStyle:{fontSize:"20px"},todayStr:"",currentHouseTypeName:"全部房型",workDto:{checkInTime:"",checkOutTime:"",houseTypeBid:this.$store.state.workbench.currentHouseType.houseTypeBid},orderVisible:!1,orderLoading:!0,lockVisible:!1,lockLoading:!0}},methods:Object(o["a"])({},Object(it["d"])(["setCurrentHouseType","setStockData","setWorkData"]),Object(it["b"])(["getPassword","getBedCountByStatus","getStockOrderCount","getHouseTypeList","getStockOfPerDay","getStockWorkbench","getOrderEnums"]),{init:function(){this.todayStr=Object(y["d"])(new Date,"date"),this.workDto.checkInTime=Object(y["a"])(this.todayStr,-1),this.workDto.checkOutTime=Object(y["a"])(this.todayStr,29)},handleHouseType:function(t){var e="",a="";if(-1!==t){var r=this.$store.state.workbench.houseTypeList[t];e=r.bid,a=r.houseTypeParentName+"-"+r.houseTypeName}else a="全部房型";this.workDto.houseTypeBid!==e&&(this.setCurrentHouseType({houseTypeName:a,houseTypeBid:e}),this.currentHouseTypeName=a,this.workDto.houseTypeBid=e)},handleDateChange:function(t){this.todayStr=t},validOrder:function(){this.$refs.createOrderRef.validateForm()},handleSaveOrder:function(t){var e=this;Object(lt["q"])(t).then(function(t){e.$Message.success("订单创建成功");var a=t.body,r={name:"orderDetail",query:{orderNumber:a}};e.$router.push(r)}).catch(function(){e.handleOrderError()})},handleOrderError:function(){var t=this;setTimeout(function(){t.orderLoading=!1,t.$nextTick(function(){t.orderLoading=!0})},500)},validLock:function(){this.$refs.lockRef.validateForm()},handleLockBed:function(t){var e=this;Object(O["f"])(t).then(function(t){e.$Message.success("锁定成功"),e.lockVisible=!1,e.handleRefresh()}).catch(function(){e.handleLockError()})},handleLockError:function(){var t=this;setTimeout(function(){t.lockLoading=!1,t.$nextTick(function(){t.lockLoading=!0})},500)},handleRefresh:function(){this.getStockOfPerDay(this.workDto),this.getStockWorkbench(this.workDto)},toRefundList:function(t){var e={name:"refundList",query:{orderNumber:t}};this.$router.push(e)}}),watch:{todayStr:function(t){this.workDto.checkInTime=Object(y["a"])(t,-1),this.workDto.checkOutTime=Object(y["a"])(t,29)},workDto:{handler:function(t){this.setStockData([]),this.setWorkData([]),this.getStockOfPerDay(t),this.getStockWorkbench(t)},deep:!0}},created:function(){this.init(),this.getPassword(),this.getBedCountByStatus(),this.getStockOrderCount(),this.getHouseTypeList(),this.getOrderEnums(),this.getStockOfPerDay(this.workDto),this.getStockWorkbench(this.workDto)}},dt=ct,ut=(a("d4d7"),Object(u["a"])(dt,r,n,!1,null,"2151df7c",null));ut.options.__file="workbench.vue";e["default"]=ut.exports},d4d7:function(t,e,a){"use strict";var r=a("6de3"),n=a.n(r);n.a},df77:function(t,e,a){},f8b5:function(t,e,a){"use strict";var r=a("010b"),n=a.n(r);n.a}}]);