(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28b24752"],{"048c":function(t,e,a){"use strict";var r=a("a4b6"),n=a.n(r);n.a},"149e":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("guest-form",{on:{search:t.listData,exportList:t.exportFile}}),a("Table",{staticClass:"my-table",attrs:{stripe:"",columns:t.columns,data:t.guestData,loading:t.loading}}),a("Page",{staticClass:"my-page",attrs:{total:t.total,"show-total":"",current:t.paramDto.pageNum,"page-size":t.paramDto.pageSize},on:{"update:current":function(e){t.$set(t.paramDto,"pageNum",e)},"on-change":t.handlePageChange}}),a("export-file",{ref:"exportFile"})],1)},n=[],o=(a("f751"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{attrs:{model:t.paramDto,"label-width":90}},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"订单号"}},[a("Input",{attrs:{placeholder:"",clearable:""},model:{value:t.paramDto.orderNumber,callback:function(e){t.$set(t.paramDto,"orderNumber","string"===typeof e?e.trim():e)},expression:"paramDto.orderNumber"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"入住人姓名"}},[a("Input",{attrs:{placeholder:"",clearable:""},model:{value:t.paramDto.name,callback:function(e){t.$set(t.paramDto,"name","string"===typeof e?e.trim():e)},expression:"paramDto.name"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"入住人手机号"}},[a("Input",{attrs:{placeholder:"",clearable:""},model:{value:t.paramDto.phone,callback:function(e){t.$set(t.paramDto,"phone","string"===typeof e?e.trim():e)},expression:"paramDto.phone"}})],1)],1)],1),a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"预定日期"}},[a("DatePicker",{staticClass:"my-date-picker",attrs:{type:"daterange","split-panels":"",placeholder:"",editable:!1},model:{value:t.paramDto.createTime,callback:function(e){t.$set(t.paramDto,"createTime",e)},expression:"paramDto.createTime"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"入住日期"}},[a("DatePicker",{staticClass:"my-date-picker",attrs:{type:"daterange","split-panels":"",placeholder:"",editable:!1},model:{value:t.paramDto.actualStartDate,callback:function(e){t.$set(t.paramDto,"actualStartDate",e)},expression:"paramDto.actualStartDate"}})],1)],1),a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"退房日期"}},[a("DatePicker",{staticClass:"my-date-picker",attrs:{type:"daterange","split-panels":"",placeholder:"",editable:!1},model:{value:t.paramDto.actualEndDate,callback:function(e){t.$set(t.paramDto,"actualEndDate",e)},expression:"paramDto.actualEndDate"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:12}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.search}},[t._v(" 查 询")])],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("Button",{attrs:{type:"warning",icon:"ios-cloud-download-outline"},on:{click:t.exportList}},[t._v(" 导 出")])],1)],1)],1)}),i=[],l=(a("386d"),{name:"guestForm",data:function(){return{paramDto:{projectBid:"",orderNumber:"",name:"",phone:"",createTime:[],actualStartDate:[],actualEndDate:[]}}},methods:{search:function(){this.paramDto.projectBid=this.$store.state.user.currentProject.bid,this.$emit("search",this.paramDto)},exportList:function(){this.$emit("exportList",this.paramDto)}},created:function(){this.search()}}),s=l,c=(a("048c"),a("2877")),u=Object(c["a"])(s,o,i,!1,null,"fc2dfe7a",null);u.options.__file="guestForm.vue";var p=u.exports,m=a("7320"),d=a("ef05"),f={name:"guestData",components:{guestForm:p,ExportFile:d["a"]},data:function(){return{paramDto:{pageNum:1,pageSize:10},loading:!1,guestData:[],total:0,columns:[{title:"入住人",key:"name"},{title:"入住人手机号",key:"phone"},{title:"预订人",key:"bookName"},{title:"预订人手机号",key:"bookPhone"},{title:"订单号",key:"orderNumber",width:190},{title:"订单状态",key:"orderStatusName"},{title:"项目",key:"projectName"},{title:"入住时间",key:"actualStartDate"},{title:"退房时间",key:"actualEndDate"},{title:"预定时间",key:"createTime",width:150},{title:"客户分层",key:"guestType"},{title:"累计入住次数",key:"checkInTimes"},{title:"订单来源",key:"orderChannelName"},{title:"获知渠道",key:"channel"},{title:"到达城市目的",key:"purpose"},{title:"年龄",key:"age"},{title:"印象最深刻",key:"deepestImpression"},{title:"意见建议",key:"suggestion",tooltip:!0}]}},methods:{listData:function(t){this.flushData(t),Object.assign(this.paramDto,t),this.paramDto.pageNum=1,this.handlePageChange()},handlePageChange:function(){var t=this;this.loading=!0,Object(m["a"])(this.paramDto).then(function(e){t.guestData=e.body.rows,t.total=e.body.total,t.loading=!1}).catch(function(){t.loading=!1})},flushData:function(t){t.createTime&&t.createTime[0]?(t.createTime[0]=t.createTime[0].getTime(),t.createTime[1]=t.createTime[1].getTime()):t.createTime=null,t.actualStartDate&&t.actualStartDate[0]?(t.actualStartDate[0]=t.actualStartDate[0].getTime(),t.actualStartDate[1]=t.actualStartDate[1].getTime()):t.actualStartDate=null,t.actualEndDate&&t.actualEndDate[0]?(t.actualEndDate[0]=t.actualEndDate[0].getTime(),t.actualEndDate[1]=t.actualEndDate[1].getTime()):t.actualEndDate=null},exportFile:function(t){this.flushData(t);var e={type:1001,jsonParam:JSON.stringify(t)};this.$refs.exportFile.requestExportFile(e)}}},h=f,b=(a("9575"),Object(c["a"])(h,r,n,!1,null,"c4908d32",null));b.options.__file="guestData.vue";e["default"]=b.exports},2934:function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"a",function(){return o}),a.d(e,"d",function(){return i}),a.d(e,"c",function(){return l});var r=a("6b6c"),n=function(){return r["a"].request({url:"/project/getCity.action",method:"get"})},o=function(t){return r["a"].request({url:"/project/getAreaByCity.action",method:"get",params:{cityCode:t}})},i=function(t){return r["a"].request({url:"/system/requestExportFile.action",method:"post",data:t})},l=function(t){return r["a"].request({url:"/system/getExportProcess",method:"get",params:{key:t}})}},"386d":function(t,e,a){"use strict";var r=a("cb7c"),n=a("83a1"),o=a("5f1b");a("214f")("search",1,function(t,e,a,i){return[function(a){var r=t(this),n=void 0==a?void 0:a[e];return void 0!==n?n.call(a,r):new RegExp(a)[e](String(r))},function(t){var e=i(a,t,this);if(e.done)return e.value;var l=r(t),s=String(this),c=l.lastIndex;n(c,0)||(l.lastIndex=0);var u=o(l,s);return n(l.lastIndex,c)||(l.lastIndex=c),null===u?-1:u.index}]})},7320:function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"a",function(){return o});var r=a("6b6c"),n=function(t){return r["a"].request({url:"/reportGuest/getReport.action",method:"post",data:t})},o=function(t){return r["a"].request({url:"/reportGuest/getGuestInfoReport.action",method:"post",data:t})}},"77fa":function(t,e,a){},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},9575:function(t,e,a){"use strict";var r=a("77fa"),n=a.n(r);n.a},9709:function(t,e,a){},a4b6:function(t,e,a){},b0e1:function(t,e,a){"use strict";var r=a("9709"),n=a.n(r);n.a},ef05:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:t.title,closable:!1,"mask-closable":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("Progress",{attrs:{percent:t.percent}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancelExport}},[t._v("取消")])],1)],1)},n=[],o=a("2934"),i={name:"ExportFile",props:{},data:function(){return{title:"",visible:!1,percent:0,interval:""}},methods:{requestExportFile:function(t){var e=this;this.title="导出文件准备中...",this.percent=0,this.visible=!0,Object(o["d"])(t).then(function(t){e.title="正在导出文件...",e.interval=setInterval(function(){return e.getExportProcess(t.body)},300)}).catch(function(){e.visible=!1})},getExportProcess:function(t){var e=this;Object(o["c"])(t).then(function(t){t.body.finish?(e.percent=100,setTimeout(function(){e.visible=!1},800),e.$Message.success("文件已生成，开始下载"),clearInterval(e.interval),e.download(t.body.fileUrl)):e.percent=t.body.percent}).catch(function(){e.visible=!1,clearInterval(e.interval)})},download:function(t){var e=document.createElement("a");e.href=t,e.style="visibility: hidden",e.download="".concat(Date.now(),".xls"),document.body.appendChild(e),e.click(),this.$forceUpdate(),setTimeout(function(){document.body.removeChild(e)},1e3)},cancelExport:function(){this.visible=!1,clearInterval(this.interval)}}},l=i,s=(a("b0e1"),a("2877")),c=Object(s["a"])(l,r,n,!1,null,"e5be986e",null);c.options.__file="ExportFile.vue";e["a"]=c.exports}}]);