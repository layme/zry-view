(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc80f896"],{"12a6":function(t,e,a){"use strict";var r=a("2ce4"),n=a.n(r);n.a},2934:function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"a",function(){return i}),a.d(e,"d",function(){return o}),a.d(e,"c",function(){return c});var r=a("6b6c"),n=function(){return r["a"].request({url:"/project/getCity.action",method:"get"})},i=function(t){return r["a"].request({url:"/project/getAreaByCity.action",method:"get",params:{cityCode:t}})},o=function(t){return r["a"].request({url:"/system/requestExportFile.action",method:"post",data:t})},c=function(t){return r["a"].request({url:"/system/getExportProcess",method:"get",params:{key:t}})}},"2ce4":function(t,e,a){},"4e16":function(t,e,a){},"5b8d":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",[a("Col",{attrs:{span:18}},[a("Form",{attrs:{model:t.paramDto,"label-width":80,inline:""},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.getData(e):null}}},[a("FormItem",{attrs:{label:"项目"}},[a("Select",{staticClass:"my-input",attrs:{placeholder:""},model:{value:t.paramDto.projectBid,callback:function(e){t.$set(t.paramDto,"projectBid",e)},expression:"paramDto.projectBid"}},t._l(t.$store.state.user.projectList,function(t){return a("Option",{key:t.bid,attrs:{label:t.projectName,value:t.bid}})}))],1),a("FormItem",{attrs:{label:"日期区间"}},[a("DatePicker",{staticClass:"my-input",attrs:{type:"daterange","split-panels":"",placeholder:"",clearable:!1,editable:!1,options:t.pickerOptions},model:{value:t.paramDto.date,callback:function(e){t.$set(t.paramDto,"date",e)},expression:"paramDto.date"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.getData}},[t._v(" 查 询")])],1)],1)],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[a("Button",{attrs:{type:"warning",icon:"ios-cloud-download-outline"},on:{click:t.exportFile}},[t._v(" 导 出")])],1)],1),a("Table",{attrs:{columns:t.columns,data:t.listDate},scopedSlots:t._u([{key:"type",fn:function(e){var r=e.row;return[1===r.type?a("Tag",{attrs:{color:"blue"}},[t._v("运营期")]):a("Tag",{attrs:{color:"green"}},[t._v("销售期")])]}}])}),a("export-file",{ref:"exportFile"})],1)},n=[],i=a("90de"),o=a("6b6c"),c=function(t){return o["a"].request({url:"/reportDaily/reportDailyIndex.action",method:"get",params:t})},s=a("ef05"),l={name:"dailyIndex",components:{ExportFile:s["a"]},data:function(){return{paramDto:{projectBid:this.$store.state.user.projectList[0].bid,date:[],startCreateTime:"",endCreateTime:""},loading:!1,listDate:[],columns:[{title:"日期",key:"recordDate"},{title:"床位数",key:"bedTotalCount"},{title:"入住床位数",key:"checkinCount"},{title:"OCC（入住率）",key:"occ",render:function(t,e){return t("div","".concat(e.row.occ,"%"))}},{title:"ADR（已售客房平均房价）",key:"ard"},{title:"RevPAR（每间可售房收入）",key:"revpar"}],pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}},visible:!1,percent:0,interval:""}},methods:{getData:function(){var t=this;this.loading=!0;var e={projectBid:this.paramDto.projectBid,startCreateTime:Object(i["f"])(this.paramDto.date[0],"date"),endCreateTime:Object(i["f"])(this.paramDto.date[1],"date")};c(e).then(function(e){t.listDate=e.body.rows,t.loading=!1}).catch(function(){t.loading=!1})},exportFile:function(){this.percent=0;var t={type:1e3,jsonParam:JSON.stringify({projectBid:this.paramDto.projectBid,startCreateTime:Object(i["f"])(this.paramDto.date[0],"date"),endCreateTime:Object(i["f"])(this.paramDto.date[1],"date")})};this.$refs.exportFile.requestExportFile(t)}},created:function(){var t=new Date(Date.now()-864e5);this.paramDto.date.push(t),this.paramDto.date.push(t),this.getData()}},u=l,d=(a("f231"),a("2877")),p=Object(d["a"])(u,r,n,!1,null,"515cd658",null);p.options.__file="dailyIndex.vue";e["default"]=p.exports},ef05:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:t.title,closable:!1,"mask-closable":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("Progress",{attrs:{percent:t.percent}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancelExport}},[t._v("取消")])],1)],1)},n=[],i=a("2934"),o={name:"ExportFile",props:{},data:function(){return{title:"",visible:!1,percent:0,interval:""}},methods:{requestExportFile:function(t){var e=this;this.title="导出文件准备中...",this.percent=0,this.visible=!0,Object(i["d"])(t).then(function(t){e.title="正在导出文件...",e.interval=setInterval(function(){return e.getExportProcess(t.body)},300)}).catch(function(){e.visible=!1})},getExportProcess:function(t){var e=this;Object(i["c"])(t).then(function(t){t.body.finish?(e.percent=100,setTimeout(function(){e.visible=!1},800),e.$Message.success("文件已生成，开始下载"),clearInterval(e.interval),e.download(t.body.fileUrl)):e.percent=t.body.percent}).catch(function(){e.visible=!1,clearInterval(e.interval)})},download:function(t){var e=document.createElement("a");e.href=t,e.style="visibility: hidden",e.download="".concat(Date.now(),".xls"),document.body.appendChild(e),e.click(),this.$forceUpdate(),setTimeout(function(){document.body.removeChild(e)},1e3)},cancelExport:function(){this.$Message.info("文件导出已取消"),this.visible=!1,clearInterval(this.interval)}}},c=o,s=(a("12a6"),a("2877")),l=Object(s["a"])(c,r,n,!1,null,"b2d706fc",null);l.options.__file="ExportFile.vue";e["a"]=l.exports},f231:function(t,e,a){"use strict";var r=a("4e16"),n=a.n(r);n.a}}]);